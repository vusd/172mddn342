var canvasWidth = 960;
var canvasHeight = 500;
var button;
var curRandomSeed;
var mainFace;
var faceImages = [];
var curFaceIndex = 0;
var curTrainIndex = 0;
var main_canvas;
var faceSelector;
var facelist = [];
var NUMFACES = 6*9;
var sliders = [];
var NUM_SLIDERS = 12;
var sliderTint;

var faceData = [
  {"landmarks": [{"nose_bridge": [[-0.09083664800859323, -1.1331171913324525], [-0.08996869920096179, -0.7900363379039251], [-0.08910075039333033, -0.4469554844753977], [-0.08823280158569889, -0.10387463104687027]], "left_eyebrow": [[-1.4637609493587556, -1.3671629100139842], [-1.2796259928409857, -1.6051477809763048], [-0.9895271050493772, -1.6850547038354993], [-0.6727703212070726, -1.6594650524711185], [-0.38220407636520126, -1.5546361311764905]], "left_eye": [[-1.119945677708386, -1.0777316751513233], [-0.9354768947261425, -1.1837623717180563], [-0.7243502156932026, -1.1842964940612142], [-0.539147014489117, -1.0000280069576548], [-0.7238160933500448, -0.9731698150282742], [-0.9614003725549969, -0.9989597622713392]], "right_eye": [[0.49009554579646525, -1.0026318533805492], [0.6743640329000248, -1.1878350545846348], [0.9118147815191875, -1.2148267770998047], [1.0968844521374834, -1.0833399597544804], [0.9122821385694505, -1.0300909329459822], [0.6748313899502878, -1.0030992104308123]], "nose_tip": [[-0.45710360225729124, 0.1345775969657134], [-0.27223422751767934, 0.18689190967368527], [-0.06104078319184466, 0.21274862220964497], [0.12356153037618835, 0.15949959540114686], [0.3610122789953511, 0.13250787288597685]], "chin": [[-1.7000099227058132, -0.8651361596746993], [-1.7252657476057203, -0.4164252014368071], [-1.671349067868275, 0.03208546092240083], [-1.5646507183725944, 0.4804625926958193], [-1.4051706991186794, 0.9287061938834484], [-1.140327636226978, 1.297510229262146], [-0.8490937384561595, 1.666247499347949], [-0.5052784668057901, 1.95567873421061], [-0.029976377810096287, 2.060040298454975], [0.4448583541353344, 1.9796660185455173], [0.9193592596162916, 1.7673375642404725], [1.3407446688745401, 1.423188466125629], [1.6828908082025413, 1.0528488290103528], [1.8401008074980358, 0.6038040443079871], [1.9180715368632832, 0.12856872060518798], [1.9695846660565184, -0.37299067268383396], [1.9683828907844134, -0.8480257005079488]], "bottom_lip": [[0.8635731516777938, 0.5798835252659744], [0.5742754474009223, 0.9764804666745788], [0.205137585557751, 1.1093693551706925], [-0.03231316306141173, 1.1363610776858626], [-0.29622151185258666, 1.1370287306148097], [-0.5869212872802475, 0.9794181395619468], [-0.8516975848790539, 0.6370049390623667], [-0.7460674800696891, 0.6631287127699053], [-0.2704315646095217, 0.8994444514098576], [-0.03284728540456954, 0.9252343986529226], [0.2046034632145932, 0.8982426761377525], [0.8108582472124536, 0.6064078907308814]], "transform": {"angle": 0.002529861247795008, "center": [186.33333333333334, 183.94444444444446], "scale": 37.89182132672947}, "top_lip": [[-0.8516975848790539, 0.6370049390623667], [-0.5615986970874456, 0.5570980162031721], [-0.27149980929583734, 0.47719109334397775], [-0.03384876479799044, 0.52937187546616], [0.17714438364916008, 0.47605608336476735], [0.5467496025425944, 0.527903039022476], [0.8635731516777938, 0.5798835252659744], [0.8108582472124536, 0.6064078907308814], [0.17754497540652844, 0.6344010926394723], [-0.03344817304062208, 0.6877168847408651], [-0.27103245224557426, 0.6619269374978002], [-0.7460674800696891, 0.6631287127699053]], "right_eyebrow": [[0.22478512585450108, -1.556171732913069], [0.567532152818555, -1.6889938561162883], [0.9369370758333051, -1.7163194050959316], [1.2802182251405168, -1.6380148492662108], [1.5447274615677442, -1.4011649882831005]]}], "url": "z_face1.jpg", "embedding": [[-0.09812457114458084, 0.11998496949672699, 0.06276129186153412, -0.05255047231912613, -0.12243147939443588, -0.03132074326276779, -0.09414154291152954, -0.1242457777261734, 0.07002627849578857, -0.08147289603948593, 0.2814253270626068, -0.04594751447439194, -0.22189925611019135, -0.1113772839307785, -0.11815732717514038, 0.2204407900571823, -0.14725343883037567, -0.10374704003334045, -0.08243671804666519, 0.005101572722196579, 0.12012264132499695, -0.0025456342846155167, 0.0014407113194465637, 0.0015963278710842133, -0.08633701503276825, -0.33422884345054626, -0.045525021851062775, -0.03229425102472305, -0.03990006074309349, -0.06796583533287048, -0.04964607208967209, 0.027314048260450363, -0.234699085354805, -0.03814394026994705, 0.02356778085231781, 0.053027696907520294, -0.050578296184539795, -0.06693702191114426, 0.14406313002109528, 0.018536454066634178, -0.22719770669937134, 0.047739796340465546, 0.06735788285732269, 0.19067732989788055, 0.182114377617836, 0.019334735348820686, 0.054091211408376694, -0.15950612723827362, 0.13529177010059357, -0.20682178437709808, 0.021643809974193573, 0.18243306875228882, 0.07248902320861816, 0.06592673063278198, 0.015211593359708786, -0.08783256262540817, 0.03786002844572067, 0.13478770852088928, -0.09582363814115524, 0.016811812296509743, 0.11877749860286713, -0.05823524296283722, -0.0877673402428627, -0.121843121945858, 0.20835383236408234, 0.08842334151268005, -0.13640394806861877, -0.18775177001953125, 0.11289231479167938, -0.09115668386220932, -0.10935712605714798, 0.04192322492599487, -0.15002340078353882, -0.19342319667339325, -0.3086214065551758, 0.048502061516046524, 0.36910122632980347, 0.132289320230484, -0.23331473767757416, 0.03634979575872421, -0.08015844225883484, 0.0484822653234005, 0.12521624565124512, 0.12101111561059952, 0.008804835379123688, 0.0336700864136219, -0.09477405250072479, -0.01780793070793152, 0.22713540494441986, -0.07723923027515411, -0.023343967273831367, 0.264713853597641, 0.0039475541561841965, 0.061221860349178314, 0.009781097993254662, 0.019018054008483887, -0.07865786552429199, 0.0058430954813957214, -0.11374843120574951, -0.03492026403546333, 0.050761688500642776, -0.041851382702589035, -0.020709838718175888, 0.09610284864902496, -0.1072147861123085, 0.10397015511989594, -0.044768959283828735, 0.10082380473613739, 0.04071452468633652, -0.02748667635023594, -0.09102319180965424, -0.07456323504447937, 0.06832525879144669, -0.1713019609451294, 0.24891397356987, 0.14487513899803162, 0.0664646327495575, 0.06269458681344986, 0.20069821178913116, 0.09950415045022964, -0.002668582834303379, -0.016219403594732285, -0.1644577980041504, -0.06623447686433792, 0.10705346614122391, -0.022745352238416672, 0.059049054980278015, -0.034697555005550385]]},
  {"url": "z_face2.jpg", "embedding": [[-0.10002943128347397, -0.002971264533698559, 0.04409882426261902, -0.08042342960834503, -0.13918328285217285, -0.05096873641014099, -0.0675748884677887, -0.03445271775126457, 0.17213879525661469, -0.1289740800857544, 0.20593279600143433, -0.038095682859420776, -0.20807456970214844, -0.03513205423951149, 0.04067589342594147, 0.18801690638065338, -0.20172590017318726, -0.14577223360538483, -0.06354935467243195, -0.0328928679227829, 0.007761724293231964, 0.06754852831363678, 0.01997918263077736, 0.0867898017168045, -0.23197656869888306, -0.36380860209465027, -0.08826257288455963, -0.15048570930957794, -0.028067536652088165, -0.006293401122093201, 0.01313356589525938, 0.1122763603925705, -0.18493340909481049, -0.03600311279296875, 0.07104189693927765, 0.10923558473587036, -0.014780500903725624, -0.053669825196266174, 0.21474239230155945, 0.043618202209472656, -0.24918276071548462, -0.04855405539274216, 0.05416091904044151, 0.2509222626686096, 0.11213052272796631, -0.008110547438263893, 0.060037221759557724, -0.020381931215524673, 0.12973971664905548, -0.26530784368515015, 0.005873171612620354, 0.14386363327503204, 0.05093163251876831, 0.06247718259692192, 0.12190939486026764, -0.10820997506380081, 0.08467353880405426, 0.153029203414917, -0.22401994466781616, 0.018371853977441788, -0.0064929090440273285, -0.007204247638583183, 0.001340152695775032, -0.027905315160751343, 0.25697019696235657, 0.11021729558706284, -0.10640345513820648, -0.10520730167627335, 0.1669047623872757, -0.11952564120292664, -0.07537998259067535, 0.11944880336523056, -0.16234096884727478, -0.18609827756881714, -0.3132040798664093, -0.05591844767332077, 0.4329444468021393, 0.08397790789604187, -0.18753360211849213, 0.052566226571798325, -0.012145612388849258, -0.06690485030412674, 0.09321217238903046, 0.10295377671718597, -0.020737331360578537, 0.06169183924794197, -0.05560031533241272, 0.083901546895504, 0.23535601794719696, -0.03588230162858963, 0.01774720288813114, 0.2265700399875641, 0.04118061065673828, 0.023799866437911987, 0.06956352293491364, 0.04878733307123184, -0.043150097131729126, -0.06510938704013824, -0.12393594533205032, 0.0016987025737762451, 0.08229243010282516, -0.012456422671675682, -0.019080791622400284, 0.08945812284946442, -0.17775820195674896, 0.1187109649181366, 0.01918645016849041, -0.06475910544395447, -0.05718757212162018, 0.07448309659957886, -0.0888402909040451, -0.058351099491119385, 0.13630631566047668, -0.24056236445903778, 0.16022630035877228, 0.1560491919517517, -0.08275251090526581, 0.11594061553478241, -0.010273986496031284, 0.013581231236457825, -0.08263693749904633, -0.04651876911520958, -0.1439516544342041, -0.10474348068237305, 0.0713956207036972, -0.021647857502102852, 0.056770212948322296, -0.0075003779493272305]], "landmarks": [{"bottom_lip": [[0.8927581592050962, 0.6424316486467727], [0.5537825636977446, 0.9192459519869604], [0.2746815917751089, 1.0262170020798214], [0.05095887408256518, 1.0374194415612454], [-0.17126505382510382, 1.0239303334973733], [-0.487758802559335, 0.9303714236581127], [-0.8663368756504581, 0.6347837641018552], [-0.7196863801635536, 0.6684680503564], [-0.15627715597635683, 0.7770148580444077], [0.03975643460114093, 0.813696723868702], [0.2649779420785594, 0.7778027368419811], [0.7431100841484422, 0.6581304574828212]], "top_lip": [[-0.8663368756504581, 0.6347837641018552], [-0.4667757455710892, 0.5846897580239607], [-0.1412892581276098, 0.5300993825914422], [0.054744332449887946, 0.5667812484157364], [0.2552742923820098, 0.5293884716041408], [0.5485752833558191, 0.5967570441132304], [0.8927581592050962, 0.6424316486467727], [0.7431100841484422, 0.6581304574828212], [0.2462815536727616, 0.6775377568759201], [0.04725038352551444, 0.6902389861422192], [-0.15028199683685803, 0.6782486678632216], [-0.7196863801635536, 0.6684680503564]], "left_eye": [[-1.3413175025300474, -0.9305643487586496], [-1.0839104985829588, -1.0884172837269783], [-0.7629203804941037, -1.068933016523607], [-0.5048024655597139, -0.8302224009823166], [-0.7809058579126001, -0.7726344459800486], [-1.1265875235467522, -0.7936175029682944]], "nose_tip": [[-0.36422409702258013, 0.12004672401795025], [-0.1681905064450824, 0.15672858984224444], [0.02784308413241536, 0.1934104556665386], [0.2283730440645372, 0.15601767885494308], [0.4042114564513625, 0.11712611225847289]], "right_eyebrow": [[0.43055572940207787, -1.5417039426310204], [0.7867289235303526, -1.6935617184598504], [1.1600997162795503, -1.7204629667773232], [1.5244777703194998, -1.5992149298230165], [1.704024673263376, -1.2909260410004604]], "right_eye": [[0.5105485633671942, -0.8181551148930469], [0.749259178908485, -1.0762730298274366], [1.0717480867822151, -1.0814803101693622], [1.3081720337410576, -0.8936515795035391], [1.101646914669437, -0.7574926125107575], [0.779158006795707, -0.7522853321688321]], "nose_bridge": [[0.02720914095538606, -1.0209717434076166], [0.03391521108218621, -0.7231743830791834], [0.04212007099386105, -0.4500685702960466], [0.050324930905535886, -0.17696275751290974]], "transform": {"center": [272.40277777777777, 193.26388888888889], "angle": -0.060626133324491974, "scale": 40.42528306397457}, "left_eyebrow": [[-1.7879750591175618, -1.3294145678507174], [-1.5477656537913962, -1.6122240303304036], [-1.1683997019026995, -1.7378914688290623], [-0.7748337309628293, -1.6892192847257705], [-0.3857641293775832, -1.5664724579865892]], "chin": [[-2.1082542662191153, -0.9523352845444687], [-2.0394638717354234, -0.45250917449903877], [-1.9444831399215596, 0.024124177785969342], [-1.8218132809926504, 0.45287322476525904], [-1.6250687794278513, 0.8861186410991729], [-1.3235629285423673, 1.2265930263913993], [-0.944984855451244, 1.5221806859476563], [-0.5125273179149036, 1.7466912824377736], [-0.02169394657872184, 1.826050173225861], [0.45344061592141155, 1.7557609889572938], [0.8649920642797783, 1.508134602517027], [1.2286592073324263, 1.232819088961714], [1.5212492873189345, 0.903624110961184], [1.7195695464788803, 0.4943593311852654], [1.7974296474820926, 0.02821750739438028], [1.8490994111551338, -0.4147315586360831], [1.9022679646130496, -0.882372172211843]]}]},
  {"landmarks": [{"nose_bridge": [[-0.11915309753870079, -1.0774219445207711], [-0.13194185058151556, -0.7736549202224418], [-0.17555954511257515, -0.4195113024623971], [-0.18834829815538986, -0.11574427816406752]], "left_eye": [[-1.1424886468718944, -1.0458639582140303], [-0.9590224614704648, -1.1759386230976654], [-0.7056320306338502, -1.1939788115430956], [-0.48457800481352026, -0.989457510640156], [-0.68759184218842, -0.9405883807064809], [-0.9409822730250346, -0.9225481922610508]], "top_lip": [[-0.7026664774688184, 0.7812605781600669], [-0.5289741180541238, 0.6105831458014519], [-0.28535751320424413, 0.5519401898810417], [-0.14400155880583426, 0.6038242468707966], [0.059012278569065435, 0.5549551169371215], [0.34172418736588517, 0.658723230916631], [0.6748126896244199, 0.7933202863843856], [0.543230561212745, 0.7820389968696106], [0.06727864102776064, 0.7677427802987561], [-0.10490625485889415, 0.7662353167707163], [-0.2770911507455489, 0.7647278532426764], [-0.5808581750438785, 0.7519391001998618]], "left_eyebrow": [[-1.4936173375758595, -1.4338514445183996], [-1.26954838469945, -1.5736999353887697], [-0.9755551863878553, -1.601513949820935], [-0.6717881620895256, -1.5887251967781202], [-0.37930242730597086, -1.4443543153236307]], "transform": {"scale": 23.944885517334836, "center": [241.73611111111111, 127.75], "angle": 0.23622397528318634}, "right_eyebrow": [[0.20868396931721833, -1.4999823441879612], [0.5545612246185678, -1.6691523130185362], [0.8891571904051424, -1.7067401534374365], [1.2839035756401669, -1.672896284893112], [1.5763893104237214, -1.5285254034386222]], "right_eye": [[0.45755200956971354, -1.001467844973427], [0.6718471364593881, -1.1819191033187768], [0.9658403347709826, -1.2097331177509423], [1.1771205346045774, -1.0458145843229827], [0.9838805232164127, -0.9563426869143276], [0.6898873249048183, -0.9285286724821623]], "nose_tip": [[-0.43347236653330934, 0.11508357364299744], [-0.28234258614816443, 0.20757039810773217], [-0.14098663174975457, 0.259454455097487], [0.062027205625145125, 0.21058532516381184], [0.21466444953832986, 0.13088725374189183]], "chin": [[-1.6394956825583888, -0.9691808138481901], [-1.653791899129243, -0.4932288936632056], [-1.5868825807501379, -0.036824625451691295], [-1.5199732623710325, 0.419579642759823], [-1.3718584090419674, 0.8564362589978674], [-1.1523118467496776, 1.2331424557874615], [-0.8207308080191824, 1.539924407141871], [-0.4989235952754227, 1.8061035910213004], [-0.0034240231169682667, 1.9016053425421149], [0.4935830125695261, 1.8249221981762747], [1.042474105245775, 1.6068830994120242], [1.521440952486839, 1.2768095242095692], [1.9094284387912084, 0.9256808335056042], [2.1056833772354526, 0.49183914432363957], [2.191411302769532, -0.044263195309794834], [2.2463102868153664, -0.5299889414815142], [2.2508326773994862, -1.0465436291414787]], "bottom_lip": [[0.6748126896244199, 0.7933202863843856], [0.3387092603098055, 1.0030930226899408], [0.054489887984945945, 1.071509804597086], [-0.1582977753766888, 1.079776167055781], [-0.34025649725007867, 1.0376659360527611], [-0.5319890451102034, 0.9549529375747614], [-0.7026664774688184, 0.7812605781600669], [-0.5808581750438785, 0.7519391001998618], [-0.31769391822052884, 0.7745016792294115], [-0.13573519634713904, 0.8166119102324313], [0.0266758735527807, 0.7775166062854911], [0.543230561212745, 0.7820389968696106]]}], "url": "z_face3.jpg", "embedding": [[-0.05519425496459007, 0.03493059054017067, 0.08143620938062668, -0.08901284635066986, -0.14302502572536469, -0.02416623942553997, -0.09756344556808472, -0.08315102756023407, 0.23946982622146606, -0.15162669122219086, 0.09232431650161743, -0.014769241213798523, -0.15266633033752441, 0.0738283321261406, -0.08435601741075516, 0.1452733278274536, -0.09795519709587097, -0.16579927504062653, -0.09493180364370346, -0.062312837690114975, -0.08847658336162567, 0.021459033712744713, -0.00294596329331398, 0.012956537306308746, -0.12360681593418121, -0.35962730646133423, -0.08465795964002609, -0.05886299908161163, -0.014770012348890305, 0.003773917444050312, -0.023260220885276794, 0.10789743810892105, -0.1129622533917427, -0.047460466623306274, 0.04806378483772278, 0.11290744692087173, -0.09416302293539047, -0.0867939442396164, 0.24747592210769653, 0.03254516422748566, -0.22027653455734253, 0.0030573979020118713, 0.08847130835056305, 0.2831569314002991, 0.22063785791397095, 0.03714641183614731, 0.13540662825107574, -0.1261082887649536, 0.14653107523918152, -0.3661941885948181, 0.0811522826552391, 0.16923867166042328, 0.011623818427324295, 0.09494776278734207, 0.13868921995162964, -0.17209285497665405, 0.023121878504753113, 0.1638849526643753, -0.1638297140598297, 0.10636025667190552, 0.07150483876466751, 0.000995999202132225, -0.05054526403546333, -0.06572765111923218, 0.3229401111602783, 0.18288353085517883, -0.11134769022464752, -0.16417694091796875, 0.28029778599739075, -0.16538552939891815, -0.06219102442264557, 0.07175640761852264, -0.08962765336036682, -0.22000420093536377, -0.22248777747154236, 0.01842578500509262, 0.3819790482521057, 0.22037602961063385, -0.09785779565572739, 0.10503733158111572, -0.15017080307006836, -0.04053933173418045, 0.008872395381331444, 0.08559748530387878, -0.006650010123848915, -0.02032337710261345, -0.028860213235020638, -0.012347746640443802, 0.2899158298969269, -0.01995079219341278, 0.008609645068645477, 0.22352749109268188, 0.07356566190719604, -0.04810752719640732, -0.03028353489935398, 0.08436368405818939, -0.15227405726909637, 0.02202434279024601, -0.20539432764053345, -0.059333980083465576, 0.10269267857074738, 0.023140307515859604, 0.05972312390804291, 0.12896883487701416, -0.2676396667957306, 0.24129846692085266, -0.08049461990594864, -0.034685902297496796, 0.028595078736543655, -0.032721344381570816, -0.009528398513793945, 0.0033172406256198883, 0.22001129388809204, -0.27409398555755615, 0.15639911592006683, 0.1383773386478424, 0.07004918903112411, 0.18882378935813904, 0.07051581889390945, 0.038776811212301254, 0.0793108195066452, -0.06640178710222244, -0.1935870349407196, -0.0840207114815712, -0.048229992389678955, -0.012153556570410728, -0.03877771645784378, 0.15794801712036133]]},
  {"url": "https://scontent-syd2-1.cdninstagram.com/t51.2885-15/e35/20634693_110474426304381_1175536951256678400_n.jpg", "embedding": [[-0.06434948742389679, -0.0024062837474048138, 0.013457316905260086, -0.13760454952716827, -0.07782885432243347, -0.0326097272336483, -0.07550576329231262, -0.11027063429355621, 0.15991172194480896, -0.21385017037391663, 0.14787960052490234, -0.04309634119272232, -0.16878312826156616, 0.004337642341852188, -0.048895012587308884, 0.22118282318115234, -0.2465084344148636, -0.1538938581943512, -0.06121373176574707, 0.017647050321102142, 0.09208934754133224, 0.024556955322623253, -0.04884433001279831, 0.05720386654138565, -0.1205020546913147, -0.2967759370803833, -0.14994552731513977, -0.033904820680618286, -0.06309930980205536, -0.014797422103583813, -0.04614557325839996, -0.00926187913864851, -0.13311146199703217, 0.006801517680287361, 0.04417328163981438, 0.08913587778806686, -0.0224045030772686, -0.1519884169101715, 0.16716164350509644, 0.049321308732032776, -0.2466009110212326, 0.09037433564662933, 0.09041853249073029, 0.20099355280399323, 0.1878717690706253, -0.02567066065967083, -0.015563759952783585, -0.190803661942482, 0.18501657247543335, -0.2248716801404953, -0.012704486958682537, 0.12370685487985611, 0.02906230092048645, 0.12010033428668976, 0.04185774177312851, -0.0715087279677391, 0.08338076621294022, 0.1825292557477951, -0.15724322199821472, 0.008683722466230392, 0.05061739683151245, -0.059865713119506836, 0.008267343044281006, -0.11001555621623993, 0.19872671365737915, 0.13405148684978485, -0.13387998938560486, -0.22018550336360931, 0.10457242280244827, -0.14323820173740387, -0.14457333087921143, 0.026546547189354897, -0.1530495434999466, -0.20092426240444183, -0.2497885376214981, -0.017288561910390854, 0.37686315178871155, 0.15874511003494263, -0.19093939661979675, 0.08379606157541275, -0.032301176339387894, -0.04047559201717377, 0.17002521455287933, 0.1846965253353119, 0.0428498238325119, 0.018862586468458176, -0.03615395724773407, 0.02118091657757759, 0.2795213460922241, -0.055659350007772446, -0.0038115475326776505, 0.24325871467590332, 0.01164834201335907, 0.09222240746021271, 0.032771360129117966, 0.013789206743240356, -0.08343151956796646, 0.04562674090266228, -0.16591206192970276, -0.033202044665813446, 0.03372709080576897, 0.017015967518091202, 0.006566572934389114, 0.11564993858337402, -0.11008727550506592, 0.1600748598575592, -0.003899163566529751, 0.0007363781332969666, 0.02611439675092697, 0.014180602505803108, -0.08694899082183838, -0.036308515816926956, 0.11282915621995926, -0.19615048170089722, 0.17582936584949493, 0.16026270389556885, 0.0727701336145401, 0.08516994118690491, 0.10163966566324234, 0.08326815068721771, -0.03913598507642746, 0.0009636171162128448, -0.23755581676959991, 0.024762913584709167, 0.10351080447435379, 0.02275218814611435, 0.09435515850782394, -0.019461821764707565], [-0.01809755153954029, 0.06842115521430969, 0.022775977849960327, -0.0824776142835617, -0.09563397616147995, -0.006546758580952883, -0.09301387518644333, -0.07580921053886414, 0.15046824514865875, -0.12530161440372467, 0.16738361120224, -0.046050626784563065, -0.22449420392513275, -0.045814380049705505, -0.07524748146533966, 0.23644816875457764, -0.1378936767578125, -0.19163982570171356, -0.08716118335723877, 0.05193939805030823, 0.09445168077945709, 0.09647463262081146, -0.01378897950053215, 0.04350718483328819, -0.11957018077373505, -0.327610045671463, -0.08205433934926987, -0.02312815561890602, -0.04604858160018921, -0.018958216533064842, -0.0672551840543747, 0.033627137541770935, -0.1603398472070694, -0.0036753974854946136, 0.13077445328235626, 0.15468333661556244, 0.002885455032810569, -0.10952965915203094, 0.15249699354171753, 0.05938611552119255, -0.30551767349243164, 0.10706408321857452, 0.07487311959266663, 0.2536681294441223, 0.20432905852794647, -0.012460842728614807, 0.004066009074449539, -0.16353781521320343, 0.13847310841083527, -0.18713155388832092, 0.01564977690577507, 0.14428621530532837, 0.09221404790878296, 0.07784521579742432, 0.05035289749503136, -0.12576442956924438, 0.07877448201179504, 0.18568532168865204, -0.15744075179100037, -0.036223240196704865, 0.08006320148706436, -0.09039562940597534, 0.022176189348101616, -0.11159314215183258, 0.16633199155330658, 0.02285883203148842, -0.12541884183883667, -0.2449038177728653, 0.08156414330005646, -0.16242340207099915, -0.08695457875728607, 0.10465404391288757, -0.1712438017129898, -0.1650429666042328, -0.31114718317985535, -0.016828224062919617, 0.37040528655052185, 0.16854992508888245, -0.230664923787117, 0.07778196036815643, 0.014115212485194206, 0.05530476197600365, 0.1309521198272705, 0.13763107359409332, 0.04680697247385979, 0.03131025284528732, -0.1370338797569275, -0.026650816202163696, 0.27962827682495117, -0.07244673371315002, -0.019146129488945007, 0.21041278541088104, 0.006280992180109024, 0.061172254383563995, 0.018279898911714554, -0.008400768041610718, -0.08105571568012238, 0.012714985758066177, -0.1540411114692688, -0.04211049526929855, -0.041871000081300735, 0.013095813803374767, -0.010684534907341003, 0.1169806718826294, -0.13081030547618866, 0.10444509238004684, -0.028239455074071884, 0.011520422995090485, -0.009466593153774738, 0.02178390696644783, -0.080869659781456, -0.0600883774459362, 0.12233073264360428, -0.21379345655441284, 0.1805155724287033, 0.16242389380931854, 0.09568481892347336, 0.0662851482629776, 0.12738333642482758, 0.07340484857559204, -0.04953833669424057, -0.0140237957239151, -0.2088259905576706, -0.04534842073917389, 0.07840050011873245, -0.01670229062438011, 0.12829247117042542, -0.01978478580713272]], "landmarks": [{"left_eyebrow": [[-1.0893772751733926, -1.5976829602412819], [-0.9765281207841461, -1.7651474966948955], [-0.7807149427418287, -1.787895593659279], [-0.5722639330526317, -1.7018585917112645], [-0.36381292336343446, -1.6158215897632495]], "right_eye": [[0.3186830540979003, -1.0556398732938652], [0.4532892282696265, -1.225631976076855], [0.6759145587531755, -1.2073935998056553], [0.8843655684423727, -1.1213565978576403], [0.6769056359350795, -1.0090528554339617], [0.4810924578927621, -0.986304758469578]], "chin": [[-1.0428900040627211, -1.0077158597849538], [-1.1061789090463523, -0.6034516720534392], [-1.0773846022413127, -0.16578371007446913], [-0.980791669759458, 0.28605857269885276], [-0.8406846977126439, 0.7328457228134228], [-0.7198071791189333, 1.203917459039848], [-0.5387137338365358, 1.6238924567131865], [-0.302459494524203, 1.949256676268478], [0.06334578630110402, 2.0611147534758203], [0.5177156354038019, 1.9862788407764456], [1.0682327517720185, 1.790019997517792], [1.5792998840521235, 1.4439895821111568], [1.9982838045435578, 1.0645553924570659], [2.2958447944757134, 0.5889739355374564], [2.450225834066112, 0.019772777681704046], [2.5150512281972146, -0.5610751346390241], [2.538890149092734, -1.1151108945185204]], "right_eyebrow": [[-0.03745762662623886, -1.653735084703889], [0.2545028186815971, -1.7979061122275513], [0.6000875688718965, -1.8601041932800464], [0.939080697255972, -1.7892325893082872], [1.2664270711750714, -1.6288053398772335]], "transform": {"scale": 45.65512809587349, "angle": 0.11565402067983184, "center": [461.9861111111111, 204.19444444444446]}, "left_eye": [[-0.8278473725673, -1.0547485428611931], [-0.7534571250842611, -1.1736439070910956], [-0.5961028539481512, -1.1478228318317678], [-0.44786777094764124, -1.0106890913306656], [-0.5951117767662473, -0.9494820874600746], [-0.7524660479023572, -0.9753031627194022]], "nose_tip": [[-0.5633442384154955, 0.08320810763397547], [-0.46873346029744895, 0.13836890166391072], [-0.37665024850877815, 0.17177267591136625], [-0.20259409024894054, 0.15155214527635852], [-0.009308478535999127, 0.1070470285294951]], "nose_bridge": [[-0.26216485822282776, -1.1204652674249684], [-0.35984861463581846, -0.8224586122764762], [-0.4383029175957054, -0.5487365432398399], [-0.5577436937911757, -0.24820232176197207]], "bottom_lip": [[0.3721078654818997, 0.922712437764316], [0.12366145973902314, 1.061828332629226], [-0.11061062520950168, 1.133145601817321], [-0.21939572412190023, 1.145783433464201], [-0.308951369581195, 1.134136678999225], [-0.4086172803579936, 1.0354618454043305], [-0.3994980922223937, 0.9241491801625561], [-0.3392821655337066, 0.8730524416094688], [-0.3149975794218509, 0.8922818950625725], [-0.24719895374503587, 0.9064562158569243], [-0.13841385483263732, 0.8938183842100444], [0.2582676339107493, 0.8918362298462365]], "top_lip": [[-0.3994980922223937, 0.9241491801625561], [-0.4490583416280091, 0.6873495288846553], [-0.3938975475980739, 0.5927387507666085], [-0.3018143358094031, 0.6261425250140642], [-0.19808436955575653, 0.5699906538022249], [0.058935812357152, 0.6944865626564473], [0.3721078654818997, 0.922712437764316], [0.2582676339107493, 0.8918362298462365], [-0.17533627259137283, 0.7658038318445423], [-0.28412137150377137, 0.7784416634914221], [-0.3519199971805865, 0.7642673426970703], [-0.3392821655337066, 0.8730524416094688]]}, {"left_eyebrow": [[-1.174153380360984, -1.4239136863612827], [-1.1366209456132446, -1.6667529548899338], [-0.9332950466265433, -1.7425393870187091], [-0.7170079198193443, -1.725078480082173], [-0.4877595651916478, -1.6143702340803257]], "right_eye": [[0.352188049029449, -1.0420168484208006], [0.49268874370787274, -1.2278818404709662], [0.7322877052813994, -1.2136612404895544], [0.988088201630548, -1.0828814666765036], [0.761450467877519, -1.0038547275926042], [0.5250918132591167, -0.9947634928076879]], "chin": [[-1.076314485626795, -0.8909817936908679], [-1.1144766064549914, -0.481719374842798], [-1.07946291602908, -0.05886604209377333], [-0.9978255560705132, 0.35750667674500247], [-0.8695645265792906, 0.7673987816735295], [-0.6914395206002881, 1.1941221074581354], [-0.4964832937652066, 1.5709814567549616], [-0.28469584607404613, 1.8979768295640076], [0.08442351715161711, 1.9892432338351083], [0.577212354199625, 1.9445086225438235], [1.12049485381587, 1.7501820817891993], [1.6540564325667417, 1.4859200367355914], [2.081409444431805, 1.1413718804371702], [2.39607327550081, 0.6699139433612795], [2.51452150757382, 0.1544429576274008], [2.530001479716146, -0.4180023045849637], [2.548721758813596, -0.9671357320310006]], "right_eyebrow": [[-0.0649062324426232, -1.6493839245062372], [0.3417455655307794, -1.8009567887637874], [0.764598898279804, -1.8359704791896987], [1.1868225449483716, -1.7045610192961913], [1.4886170247497188, -1.4138387090739706]], "transform": {"scale": 42.48818258907084, "angle": 0.13811342790067305, "center": [160.08333333333334, 236.79166666666666]}, "left_eye": [[-0.9293331770381225, -1.030223116208378], [-0.8555276797035577, -1.1830553526268421], [-0.6625523876626865, -1.1623541387351817], [-0.49675892342372463, -0.9953013023353057], [-0.6567014598328947, -0.949307318883107], [-0.8464364449186416, -0.9466966980084398]], "nose_tip": [[-0.5840634581064047, 0.08613433170068883], [-0.45778336340939246, 0.13986830122405022], [-0.35805541043383254, 0.1735307429362082], [-0.17156073230321026, 0.14760828729521303], [0.014933945827412063, 0.12168583165421785]], "nose_bridge": [[-0.29991363834727214, -1.1177114039967366], [-0.35427729395109053, -0.8250081589803053], [-0.4585049260426889, -0.5491361348199533], [-0.5329401094577106, -0.22988074808207004]], "bottom_lip": [[0.45147006903023057, 0.868923916337621], [0.13482530316701477, 0.9842237180083461], [-0.12160487926259092, 1.0198670945147144], [-0.26147588786055764, 1.0393089362454608], [-0.3612038408361176, 1.0056464945333028], [-0.44086026600047423, 0.9454319110996926], [-0.5004451633536274, 0.8586651859446303], [-0.4104381312434406, 0.8223921233578049], [-0.36705476866590936, 0.7925996746812283], [-0.27056712264547383, 0.8029502816270585], [-0.1507676418587105, 0.8100605816177643], [0.30511844652201503, 0.8417420885357119]], "top_lip": [[-0.5004451633536274, 0.8586651859446303], [-0.5062960911834192, 0.6456183660925557], [-0.42600997993860557, 0.539409799206747], [-0.32628202696304565, 0.5730722409189051], [-0.1896513253202033, 0.5303185644218308], [0.0894610057952732, 0.6578580312797571], [0.45147006903023057, 0.868923916337621], [0.30511844652201503, 0.8417420885357119], [-0.16048856272408368, 0.7401250773187809], [-0.30359987827717483, 0.7362550842831995], [-0.39684721734248596, 0.7492163121036971], [-0.4104381312434406, 0.8223921233578049]]}]},  
  {"url": "https://pbs.twimg.com/media/DGnH9l8VwAASYUj.jpg", "landmarks": [{"left_eyebrow": [[-1.2569022247940032, -1.457931461988435], [-1.1414776277708902, -1.5697412065137817], [-1.0260530307477775, -1.6815509510391287], [-0.7988186891993182, -1.6779360985413627], [-0.5733917738997415, -1.5607040752693673]], "bottom_lip": [[0.7538657504133576, 0.7333284552018232], [0.4093993855929024, 0.955140518003634], [0.06674044702133014, 1.0633354100312151], [-0.1604938945271294, 1.0597205575334492], [-0.38772823607558893, 1.0561057050356835], [-0.4995379806009358, 0.9406811080125707], [-0.7231574696516295, 0.7098319139663453], [-0.6095402988773998, 0.7116393402152282], [-0.38230595732894024, 0.7152541927129941], [-0.15687904202936356, 0.8324862159849896], [0.07216272576797887, 0.7224838977085257], [0.6402485796391277, 0.7315210289529402]], "right_eye": [[0.4401256318239119, -0.9763513851582722], [0.6709748258701373, -1.1999708742089659], [0.8982091674185968, -1.1963560217112001], [1.1236360827181733, -1.0791239984392043], [0.8945943149208311, -0.9691216801627406], [0.6673599733723715, -0.9727365326605064]], "top_lip": [[-0.7231574696516295, 0.7098319139663453], [-0.4941157018542871, 0.5998295956898814], [-0.3804985310800573, 0.6016370219387643], [-0.15326418953159773, 0.6052518744365302], [0.07397015201686179, 0.608866726934296], [0.4148216643395511, 0.6142890056809447], [0.7538657504133576, 0.7333284552018232], [0.6402485796391277, 0.7315210289529402], [0.07216272576797887, 0.7224838977085257], [-0.15507161578048065, 0.7188690452107599], [-0.38230595732894024, 0.7152541927129941], [-0.6095402988773998, 0.7116393402152282]], "transform": {"angle": -0.015906696090656917, "scale": 8.800373080615655, "center": [328.2638888888889, 298.65277777777777]}, "chin": [[-1.2677467822873005, -0.7762284373430564], [-1.386786231808179, -0.4371843512692499], [-1.3940159368037106, 0.01728433182766917], [-1.2858210447761298, 0.3599432703992414], [-1.1794335789974315, 0.8162193797450433], [-0.9576215161956207, 1.1606857445654986], [-0.7358094533938099, 1.505152109385954], [-0.5139973905919991, 1.8496184742064088], [-0.1749533045181927, 1.9686579237272874], [0.3949399756018391, 1.8640778841974721], [0.8512160849476411, 1.757690418418774], [1.4247242175654389, 1.4258760373404995], [1.8846151794090067, 1.0922542300133418], [2.2326963967272273, 0.6432078256630713], [2.355350698745872, 0.07692939804080531], [2.478005000764516, -0.48934902958146065], [2.48704213200893, -1.0574348834526095]], "right_eyebrow": [[0.10831125074563713, -1.5498595177760697], [0.4527776155660923, -1.7716715805778807], [0.7936291278887817, -1.766249301831232], [1.1344806402114707, -1.760827023084583], [1.4735247262852775, -1.6417875735637044]], "nose_tip": [[-0.48688599685875544, 0.14536091259296224], [-0.3750762523334086, 0.26078550961607494], [-0.2614590815591788, 0.26259293586495785], [-0.03422474001071924, 0.2662077883627237], [0.19481702778662321, 0.15620547008625973]], "left_eye": [[-1.1505147590153049, -1.001655352642633], [-0.9214729912179624, -1.1116576709190968], [-0.6942386496695029, -1.108042818421331], [-0.582428905144156, -0.9926182213982184], [-0.6978535021672687, -0.8808084768728716], [-0.9250878437157283, -0.8844233293706374]], "nose_bridge": [[-0.23976996657258381, -1.1008131134257992], [-0.24519224531923256, -0.7599616011031102], [-0.3642316948401111, -0.4209175150293037], [-0.36965397358675983, -0.08006600270661439]]}, {"left_eyebrow": [[-1.4945885421746705, -1.2877742060422532], [-1.3780050758797373, -1.5263563663813102], [-1.0217564036959088, -1.5296055030308247], [-0.7831742433568517, -1.4130220367358914], [-0.42584252562318503, -1.2975216159907967]], "bottom_lip": [[0.7789817771203207, 0.5916408468245739], [0.4248991960361685, 0.8323890982633073], [0.06973356940217809, 0.9543877923074312], [-0.16776554538704092, 0.9565538834071076], [-0.4052646601762599, 0.9587199745067839], [-0.5250972631207077, 0.8410534626620126], [-0.7636794234597648, 0.7244699963670794], [-0.6449298660651552, 0.7233869508172412], [-0.4074307512759362, 0.721220859717565], [-0.16993163648671722, 0.7190547686178886], [0.06756747830250177, 0.7168886775182123], [0.6613152652755493, 0.7114734497690215]], "right_eye": [[0.5274030701832054, -0.9499373082056735], [0.7627360938727482, -1.1896025140945687], [1.000235208661967, -1.191768605194245], [1.2388173690010245, -1.0751851388993119], [1.0024012997616434, -0.9542694904050262], [0.7649021849724245, -0.9521033993053498]], "top_lip": [[-0.7636794234597648, 0.7244699963670794], [-0.527263354220384, 0.6035543478727937], [-0.2908472849810031, 0.4826386993785078], [-0.1710146820365554, 0.6003052112232792], [0.06540138720282544, 0.4793895627289933], [0.42273310493649213, 0.5948899834740884], [0.7789817771203207, 0.5916408468245739], [0.6613152652755493, 0.7114734497690215], [0.06756747830250177, 0.7168886775182123], [-0.16993163648671722, 0.7190547686178886], [-0.4074307512759362, 0.721220859717565], [-0.6449298660651552, 0.7233869508172412]], "transform": {"angle": 0.009120164698946614, "scale": 8.420733799144191, "center": [197.48611111111111, 304.9583333333333]}, "chin": [[-1.6100889629197657, -0.9304424883085866], [-1.605756780720413, -0.45544425873014843], [-1.6025076440708985, -0.09919558654631994], [-1.4794259044769362, 0.3747195974822799], [-1.3574272104328122, 0.7298852241162703], [-1.1155959134442406, 1.2027173625950318], [-0.8759307075553452, 1.4380503862845746], [-0.5164328987220024, 1.7910499218188887], [-0.1591011809883356, 1.9065503425639836], [0.43464660598471194, 1.9011351148147928], [0.9074787444634735, 1.6593038178262212], [1.4979773947870065, 1.2976399178932017], [1.9697264877159302, 0.9370590635100206], [2.202893420305797, 0.4598947428319063], [2.436060352895663, -0.017269577846208025], [2.549394682541082, -0.6121004103690937], [2.543979454791891, -1.205848197342141]], "right_eyebrow": [[0.16790526134986247, -1.3029368437399875], [0.5219878424340146, -1.5436850951787209], [0.8782365146178431, -1.5469342318282353], [1.353234744196281, -1.551266414027588], [1.7105664619299477, -1.4357659932824929]], "nose_tip": [[-0.5315955364197367, 0.1285561182943556], [-0.41176293347528886, 0.24622263013912693], [-0.17426381868606988, 0.2440565390394506], [0.06323529610314911, 0.24189044793977427], [0.29965136534252995, 0.12097479944548843]], "left_eye": [[-1.2538402907359372, -0.933691624958101], [-1.017424221496556, -1.0546072734523866], [-0.7799251067073373, -1.056773364552063], [-0.5413429463682802, -0.94018989825713], [-0.7777590156076609, -0.8192742497628441], [-1.0152581303968797, -0.8171081586631678]], "nose_bridge": [[-0.1861773197342897, -1.062188592301254], [-0.1829281830847752, -0.7059399201174255], [-0.1796790464352607, -0.3496912479335969], [-0.29517946718035576, 0.007640469800069753]]}, {"left_eyebrow": [[-1.695963881336698, -1.3350696451193353], [-1.293307087708677, -1.4818170260880448], [-1.0261220702659335, -1.6248058721289431], [-0.6159482067822916, -1.5006097007270982], [-0.20577434329864946, -1.376413529325253]], "bottom_lip": [[0.8026646488432618, 0.7648251451445056], [0.5317210964727076, 0.7723422150001271], [0.2607775441021534, 0.7798592848557485], [0.12530576791687628, 0.7836178197835593], [-0.14563778445367798, 0.7911348896391807], [-0.4165813368242322, 0.7986519594948022], [-0.691283424122597, 0.6706972531651464], [-0.5558116479373201, 0.6669387182373356], [-0.14939631938148867, 0.6556631134539035], [0.12154723298906556, 0.6481460435982821], [0.3924907853596198, 0.6406289737426607], [0.6671928726579847, 0.7685836800723164]], "right_eye": [[0.4828601424111683, -0.9887908754084754], [0.7538036947817225, -0.9963079452640969], [1.0247472471522767, -1.0038250151197183], [1.1602190233375538, -1.007583550047529], [1.0285057820800876, -0.8683532389344413], [0.7575622297095332, -0.8608361690788199]], "top_lip": [[-0.691283424122597, 0.6706972531651464], [-0.42033987175204296, 0.663180183309525], [-0.01768307812402229, 0.5164328023408158], [0.12154723298906556, 0.6481460435982821], [0.3887322504318091, 0.5051571975573836], [0.527962561544897, 0.63687043881485], [0.8026646488432618, 0.7648251451445056], [0.6671928726579847, 0.7685836800723164], [0.3924907853596198, 0.6406289737426607], [0.12530576791687628, 0.7836178197835593], [-0.14939631938148867, 0.6556631134539035], [-0.5558116479373201, 0.6669387182373356]], "transform": {"angle": 0.02773692885637404, "scale": 7.378772052731596, "center": [163.23611111111111, 90.19444444444444]}, "chin": [[-2.5012774685927393, -1.041574883181917], [-2.350771552696219, -0.5034463133686191], [-2.335737412984976, 0.0384407913724894], [-2.1852314970884565, 0.5765693611857873], [-2.0347255811919363, 1.1146979309990848], [-1.6207931827804836, 1.374365878586207], [-1.0713890081837534, 1.6302752912455185], [-0.5257433685148344, 1.7507129277195526], [0.01990227115408489, 1.8711505641935868], [0.42255906478210553, 1.7244031832248774], [0.8252158584101261, 1.5776558022561684], [1.224114117110336, 1.295436645102182], [1.4837820646974582, 0.8815042466907291], [1.6079782360993031, 0.47133038320708714], [1.732174407501148, 0.061156519723445], [1.7171402677899053, -0.48073058501766347], [1.705864663006473, -0.8871459135734948]], "right_eyebrow": [[0.33611276144245905, -1.391447669036496], [0.7387695550704797, -1.5381950500052055], [1.009713107441034, -1.5457121198608268], [1.419886970924676, -1.4215159484589817], [1.559117282037764, -1.2898027072015155]], "nose_tip": [[-0.2999022352780087, 0.11753454364060575], [-0.028958682907454444, 0.11001747378498433], [0.24574340439091052, 0.23797218011464003], [0.37745664564837694, 0.09874186900155217], [0.5129284218336541, 0.09498333407374146]], "left_eye": [[-1.2782729479974342, -0.9399299213469361], [-1.0110879305546907, -1.0829187673878347], [-0.7401443781841364, -1.0904358372434562], [-0.46544229088577155, -0.9624811309138004], [-0.7363858432563257, -0.954964061058179], [-1.00732939562688, -0.9474469912025576]], "nose_bridge": [[0.07268627892752623, -1.1129870468103205], [0.21567512496842478, -0.845802029367577], [0.22695072975185696, -0.4393867008117456], [0.23446779960747838, -0.16844314844119132]]}, {"left_eyebrow": [[-1.4120926389470776, -1.305110305553343], [-1.3092780088810692, -1.5579185678405774], [-1.0659055470248784, -1.5767901687026644], [-0.6914110538095488, -1.4834113390676997], [-0.4386027915223144, -1.3805967090016913]], "bottom_lip": [[0.816981894158284, 0.6031470128965386], [0.47079480223608483, 0.87482687604586], [0.11517190988284223, 1.0248205082670858], [-0.1282005519733485, 1.0436921091291729], [-0.38100881426058286, 0.9408774790631645], [-0.5121308456197218, 0.8286270485661126], [-0.7743749083379996, 0.6041261875720089], [-0.6432528769788606, 0.7163766180690608], [-0.39988041512266986, 0.6975050172069738], [-0.14707215283543557, 0.8003196472729821], [0.09630030902075518, 0.781448046410895], [0.6952956632301887, 0.6125828133275821]], "right_eye": [[0.4509440266985273, -0.9599023883066145], [0.6848806881236746, -1.1004602200967968], [0.9188173495488217, -1.2410180518869793], [1.1810614122670997, -1.0165171908928756], [0.9471247508419522, -0.8759593591026932], [0.7037522889857617, -0.8570877582406061]], "top_lip": [[-0.7743749083379996, 0.6041261875720089], [-0.5310024464818088, 0.5852545867099218], [-0.29706578505666154, 0.4446967549197394], [-0.16594375369752262, 0.5569471854167913], [0.07742870815866813, 0.5380755845547043], [0.4424874009429543, 0.5097681832615737], [0.816981894158284, 0.6031470128965386], [0.6952956632301887, 0.6125828133275821], [0.08686450858971166, 0.6597618154827998], [-0.1565079532664791, 0.6786334163448868], [-0.2781941841945745, 0.6880692167759304], [-0.6432528769788606, 0.7163766180690608]], "transform": {"angle": 0.07738719925750356, "scale": 8.193261449448098, "center": [338.7083333333333, 170.55555555555554]}, "chin": [[-1.5054714685820423, -0.9306158123380134], [-1.5894144977859634, -0.4344350881945884], [-1.5611070964928329, -0.06937639541030223], [-1.5233638947686587, 0.41736852830207927], [-1.3639344621163894, 0.8946776515834173], [-1.092254598967068, 1.2408647435056166], [-0.8205747358177468, 1.5870518354278158], [-0.5488948726684253, 1.9332389273500148], [-0.05271414852500031, 2.017181956553936], [0.4340307751873812, 1.979438754829762], [0.9113398984687193, 1.8200093221774925], [1.500899452247109, 1.529457858166084], [1.8376507437382645, 1.1360917640886672], [2.1649662347983765, 0.6210394390831551], [2.2394734635712545, 0.003172484011634641], [2.323416492775176, -0.49300824013179034], [2.3979237215480538, -1.110875195203311]], "right_eyebrow": [[0.16982836311816252, -1.427775711156909], [0.5160154550403616, -1.6994555743062303], [0.8810741478246475, -1.7277629755993609], [1.2461328406089338, -1.7560703768924915], [1.630063134255307, -1.5410053163294313]], "nose_tip": [[-0.4470594172778875, 0.08907386256649683], [-0.3159373859187486, 0.20132429306354868], [-0.19425115499065318, 0.19188849263250515], [0.04912130686553756, 0.1730168917704181], [0.17080753779363295, 0.16358109133937457]], "left_eye": [[-1.1404127757977562, -0.958923213631144], [-0.906476114372609, -1.0994810454213264], [-0.7847898834445135, -1.10891684585237], [-0.5225458207262357, -0.8844159848582663], [-0.7659182825824264, -0.8655443839961793], [-1.0092907444386172, -0.8466727831340922]], "nose_bridge": [[-0.16692292837299308, -1.034409617079492], [-0.14805132751090602, -0.7910371552233014], [-0.24143015714587082, -0.4165426620079718], [-0.22255855628378376, -0.173170200151781]]}, {"left_eyebrow": [[-1.467082372450008, -1.2452843310861488], [-1.3409717499609948, -1.4734446884330716], [-0.9867007701250587, -1.575494423290981], [-0.758540412778136, -1.449383800801968], [-0.41389378799464155, -1.318461000786734]], "bottom_lip": [[0.6691618684253232, 0.7099273208971927], [0.3148908885893873, 0.8119770557551023], [0.08191835371624384, 0.8023527007026607], [-0.15586635868312032, 0.9092146130867911], [-0.272352626119692, 0.9044024355605703], [-0.5053251609928355, 0.8947780805081289], [-0.7334855183397582, 0.7686674580191156], [-0.6169992509031865, 0.7734796355453364], [-0.2675404485934713, 0.7879161681239986], [-0.1510541811568996, 0.7927283456502193], [0.08673053124246458, 0.685866433266089], [0.5526756009887515, 0.7051151433709719]], "right_eye": [[0.5083719964454907, -1.0469910457038247], [0.746156708844855, -1.1538529580879548], [0.9791292437179985, -1.1442286030355135], [1.207289601064921, -1.0181179805465004], [0.969504888665557, -0.91125606816237], [0.7365323537924134, -0.9208804232148114]], "top_lip": [[-0.7334855183397582, 0.7686674580191156], [-0.495700805940394, 0.6618055456349854], [-0.25791609354102984, 0.5549436332508552], [-0.14142982610445812, 0.5597558107770759], [0.09154270876868531, 0.5693801658295173], [0.32451524364182877, 0.5790045208819589], [0.6691618684253232, 0.7099273208971927], [0.5526756009887515, 0.7051151433709719], [0.08673053124246458, 0.685866433266089], [-0.14624200363067885, 0.6762420782136476], [-0.2627282710672506, 0.6714299006874268], [-0.6169992509031865, 0.7734796355453364]], "transform": {"angle": -0.04128763785847867, "scale": 8.577386918987896, "center": [568.0138888888889, 228.15277777777777]}, "chin": [[-1.5980051724652418, -0.9006377063026543], [-1.6172538825701248, -0.4346926365563674], [-1.520016325238436, 0.036064610716140186], [-1.4227787679067474, 0.5068218579886479], [-1.3207290330488377, 0.8610928378245838], [-1.107005208280577, 1.336662262623312], [-0.8884692059860958, 1.6957454199854687], [-0.5486347587288221, 1.9431544874372744], [-0.08268968898253518, 1.9624031975421572], [0.3880675582899724, 1.8651656402104686], [0.9801232505252726, 1.6562539929684288], [1.455692675324001, 1.442530168200168], [1.93607427764895, 1.1123200759953362], [2.1882955226269765, 0.6559993613014905], [2.328842677694652, 0.07838020164485261], [2.352903565325755, -0.504051135538006], [2.4934507203934304, -1.081670295194644]], "right_eyebrow": [[0.17334972671443777, -1.410886380592202], [0.5324328840765944, -1.6294223828866832], [0.8867038639125303, -1.7314721177445929], [1.3478367561325963, -1.5957371402031382], [1.6876712033898702, -1.3483280727513327]], "nose_tip": [[-0.4668277407830696, -0.037112058984444946], [-0.35515365087271866, 0.08418638597834752], [-0.23866738343614693, 0.08899856350456825], [-0.0008826710367827465, -0.017863348879562018], [0.2320898638363607, -0.008238993827120556]], "left_eye": [[-1.127247925192734, -0.9978752636343432], [-1.0059494802299418, -1.1095493535446943], [-0.7729769453567982, -1.0999249984922528], [-0.5448165880098755, -0.9738143760032395], [-0.7826013004092397, -0.8669524636191092], [-1.015573835282383, -0.8765768186715507]], "nose_bridge": [[-0.19054560817393962, -1.075864110861149], [-0.2001699632263811, -0.8428915759880056], [-0.20979431827882253, -0.6099190411148621], [-0.219418673331264, -0.37694650624171866]]}, {"left_eyebrow": [[-1.495838286723166, -1.5126393389948927], [-1.262726566984722, -1.7839949076064416], [-0.8843761007222272, -1.8126777942612706], [-0.6225814943289543, -1.705682896610325], [-0.22510910362990671, -1.4821321390901576]], "bottom_lip": [[0.7036891488240572, 0.730604885175154], [0.46101646686733694, 0.8758436316992049], [0.20878282269234033, 0.8949655561357576], [0.082666000604842, 0.904526518354034], [-0.16956764357015458, 0.9236484427905866], [-0.4313622499634276, 0.816653545139641], [-0.8192736784441988, 0.7192196097069717], [-0.6931568563567004, 0.7096586474886954], [-0.18868956800670728, 0.6714147986155901], [0.06354407616828933, 0.6522928741790375], [0.31577772034328594, 0.6331709497424848], [0.7036891488240572, 0.730604885175154]], "right_eye": [[0.45327981789896654, -0.8993528397440477], [0.822069321943185, -1.054152548486375], [1.0743029661181815, -1.0732744729229275], [1.2099807504239564, -0.9567186130537058], [0.967308068467236, -0.8114798665296548], [0.7150744242922394, -0.7923579420931021]], "top_lip": [[-0.8192736784441988, 0.7192196097069717], [-0.44092321218170394, 0.6905367230521428], [-0.07213370813748532, 0.5357370143098154], [0.06354407616828933, 0.6522928741790375], [0.3062167581250096, 0.5070541276549864], [0.5680113645182826, 0.6140490253059321], [0.7036891488240572, 0.730604885175154], [0.7036891488240572, 0.730604885175154], [0.3253386825615623, 0.759287771829983], [0.07310503838656567, 0.7784096962665357], [-0.17912860578843093, 0.7975316207030883], [-0.6931568563567004, 0.7096586474886954]], "transform": {"angle": 0.07566563026752006, "scale": 7.906468821692466, "center": [452.8888888888889, 107.81944444444444]}, "chin": [[-2.204734408156774, -0.824689455247743], [-2.1664905592836687, -0.3202221668977496], [-2.1282467104105636, 0.18424512145224353], [-2.090002861537458, 0.6887124098022367], [-1.9352031527951308, 1.0575019138464552], [-1.528169799877807, 1.4071694934541212], [-1.004580587091261, 1.6211592887560125], [-0.49055233652299146, 1.7090322619704053], [0.02347591404527806, 1.7969052351847983], [0.5279432023952713, 1.758661386311693], [1.013288566308712, 1.4681838932635911], [1.3820780703529305, 1.313384184521264], [1.4795120057855997, 0.9254727560404925], [1.576945941218269, 0.5375613275597214], [1.664818914432662, 0.023533076991451768], [1.6361360277778327, -0.3548173892710431], [1.724009000992226, -0.8688456398393127]], "right_eyebrow": [[0.5315918288950832, -1.5394979123998156], [0.7742645108518034, -1.6847366589238666], [1.0264981550268, -1.7038585833604194], [1.2787317992017968, -1.722980507796972], [1.4239705457258476, -1.4803078258402518]], "nose_tip": [[-0.3530502389673109, 0.17650847248387314], [-0.10081659479231432, 0.15738654804732047], [0.16097801160095865, 0.2643814456982661], [0.2775338714701806, 0.12870366139249145], [0.4036506935576789, 0.11914269917421512]], "left_eye": [[-1.205360793675064, -1.0272939750814518], [-0.9531271495000676, -1.0464158995180044], [-0.7008935053250709, -1.0655378239545572], [-0.43909889893179793, -0.9585429263036116], [-0.6913325431067946, -0.9394210018670589], [-0.9435661872817913, -0.9202990774305063]], "nose_bridge": [[0.055807427199918935, -1.1229035972642152], [0.08449031385474795, -0.7445531310017204], [0.10361223829130062, -0.4923194868267237], [0.2584119470336279, -0.12352998278250515]]}, {"left_eyebrow": [[-1.5315844979912365, -1.2472068461352324], [-1.2876069672868535, -1.4974965398239057], [-1.042051395836398, -1.6242194274143151], [-0.6713509775416058, -1.6289535496525331], [-0.29907251850074096, -1.510120865792487]], "bottom_lip": [[0.8398554290668707, 0.5763124711633484], [0.47231109226422385, 0.8281802055980944], [0.22675552081376837, 0.9549030931885037], [-0.02037809138275975, 0.958059174680649], [-0.2675117035792879, 0.9612152561727944], [-0.5162233565218887, 0.8408045315666756], [-0.7649350094644894, 0.7203938069605569], [-0.6413682033662254, 0.7188157662144843], [-0.1471009789731691, 0.7125036032301937], [-0.023534172874905054, 0.710925562484121], [0.22359943932162307, 0.7077694809919757], [0.7178666637146793, 0.7014573180076851]], "right_eye": [[0.5722072871713981, -1.0268999266219392], [0.6941960525235895, -1.152044773466276], [0.9413296647201176, -1.1552008549584214], [1.1900413176627185, -1.0347901303523024], [0.9444857462122629, -0.9080672427618932], [0.6973521340157348, -0.9049111612697479]], "top_lip": [[-0.7649350094644894, 0.7203938069605569], [-0.519379438014034, 0.5936709193701475], [-0.1502570604653144, 0.4653699910336654], [0.09845459247728637, 0.5857807156397843], [0.22044335782947777, 0.46063586879544743], [0.46915501077207855, 0.5810465934015663], [0.8398554290668707, 0.5763124711633484], [0.7178666637146793, 0.7014573180076851], [0.22359943932162307, 0.7077694809919757], [-0.023534172874905054, 0.710925562484121], [-0.1471009789731691, 0.7125036032301937], [-0.6413682033662254, 0.7188157662144843]], "transform": {"angle": 0.012770055451461797, "scale": 8.092128424479656, "center": [317.2638888888889, 78.25]}, "chin": [[-1.895972753301738, -0.7482054995039581], [-1.8896605903174475, -0.2539382751109018], [-1.8849264680792295, 0.11676214318389037], [-1.7550474989966747, 0.609451326830874], [-1.6267465706601927, 0.9785737043795936], [-1.3748788362254465, 1.3461180411822404], [-0.9994442956924364, 1.7120843372388146], [-0.6255877959054988, 1.9544838271971245], [-0.12974253076636993, 2.0717384703110984], [0.48809149972495036, 2.063848266580735], [0.9792026426258613, 1.8104024913999162], [1.3451689386824357, 1.434967950866906], [1.7111352347390099, 1.0595334103338958], [1.8283898778529832, 0.5636881451947671], [1.9456445209669568, 0.06784288005563814], [1.9409103987287388, -0.302857538239154], [1.9345982357444482, -0.7971247626322103]], "right_eyebrow": [[0.3187615119905794, -1.5180110695228504], [0.5658951241871075, -1.5211671510149956], [0.935017501735827, -1.6494680793514775], [1.307295960776692, -1.5306353954914316], [1.5575856544653652, -1.2866578647870486]], "nose_tip": [[-0.40370283564613313, -0.025741151867245515], [-0.15656922344960503, -0.028897233359390817], [-0.03142437660526832, 0.09309153199280058], [0.21413119484518714, -0.03363135559760878], [0.33769800094345126, -0.03520939634368143]], "left_eye": [[-1.1577279982042987, -1.0048073561769222], [-0.9121724267538432, -1.1315302437673316], [-0.6650388145573152, -1.134686325259477], [-0.5398939677129784, -1.0126975599072854], [-0.7870275799095066, -1.00954147841514], [-1.0341611921060347, -1.0063853969229948]], "nose_bridge": [[-0.04720478406599484, -1.1425765289898402], [-0.04404870257384954, -0.895442916793312], [-0.04089262108170423, -0.6483093045967838], [-0.03773653958955893, -0.4011756924002557]]}, {"left_eyebrow": [[-1.4321182903859127, -1.768137204639537], [-1.1747344061529708, -1.765839941489729], [-1.0460424640364998, -1.764691309914825], [-0.789807211378462, -1.633702104648546], [-0.5335719587204242, -1.5027128993822672]], "bottom_lip": [[0.7326720940960129, 0.8252283744632496], [0.3442990045967921, 1.0791663639714795], [0.08691512036385024, 1.0768691008216715], [-0.1704687638690916, 1.0745718376718634], [-0.29916070598556255, 1.0734232060969595], [-0.4267040165271294, 0.9435826324055844], [-0.5530986954937923, 0.6850501165977386], [-0.4244067533773214, 0.6861987481726426], [-0.2968634428357545, 0.8160393218640175], [-0.1681715007192836, 0.8171879534389216], [0.08921238351365826, 0.8194852165887296], [0.6039801519795419, 0.8240797428883456]], "right_eye": [[0.3626771097952562, -0.9799047098920554], [0.6223582571780061, -1.2349913309751892], [0.8797421414109479, -1.232694067825381], [1.1359773940689857, -1.1017048625591022], [1.0049881888027068, -0.8454696099010643], [0.6189123624532941, -0.8489155046257764]], "top_lip": [[-0.5530986954937923, 0.6850501165977386], [-0.4244067533773214, 0.6861987481726426], [-0.2945661796859465, 0.5586554376310756], [-0.16702286914437958, 0.6884960113224506], [-0.03718229545300465, 0.5609527007808837], [0.3477448993215041, 0.6930905376220666], [0.7326720940960129, 0.8252283744632496], [0.6039801519795419, 0.8240797428883456], [-0.03947955860281267, 0.8183365850138256], [-0.1681715007192836, 0.8171879534389216], [-0.2968634428357545, 0.8160393218640175], [-0.4244067533773214, 0.6861987481726426]], "transform": {"angle": -0.008925198082928344, "scale": 7.770184785765283, "center": [195.25, 173.63888888888889]}, "chin": [[-1.4390100798353367, -0.9959855519407115], [-1.4436046061349528, -0.48121778347482774], [-1.4470505008596648, -0.09514195712541498], [-1.194261142926339, 0.4219230744902768], [-1.06901509553458, 0.8091475324145935], [-0.8139284744514461, 1.0688286797973434], [-0.5599904849432163, 1.457201769296564], [-0.30490386386008256, 1.716882916679314], [-0.04866861120204473, 1.847872121945593], [0.46609915726383894, 1.852466648245209], [0.8533236151881557, 1.72722060085345], [1.3715372783787514, 1.3457393008036531], [1.7599103678779724, 1.0918013112954237], [2.1505807205270013, 0.5804794375542518], [2.283867188943088, 0.06686030066327214], [2.288461715242704, -0.44790746780261154], [2.4228968152336954, -1.090218546810062]], "right_eyebrow": [[0.1098877518619304, -1.496969741507747], [0.49711220978624715, -1.622215788899506], [0.8843366677105639, -1.7474618362912648], [1.1417205519435059, -1.745164573141457], [1.5266477467180146, -1.613026736300274]], "nose_tip": [[-0.5485041691941763, 0.17028234813185492], [-0.4209608586526094, 0.3001229218232298], [-0.2922689165361385, 0.30127155339813383], [-0.03488503230319664, 0.3035688165479418], [0.09380690981327429, 0.30471744812284585]], "left_eye": [[-1.180477564027491, -1.1223802309073743], [-1.050636990336116, -1.2499235414489411], [-0.793253106103174, -1.2476262782991332], [-0.5381664850200403, -0.9879451309163834], [-0.7955503692529821, -0.9902423940661914], [-1.0529342534859238, -0.9925396572159995]], "nose_bridge": [[-0.2796339692121944, -1.1143398098830462], [-0.28307986393690643, -0.7282639835336336], [-0.28652575866161845, -0.3421881571842208], [-0.41866359550280136, 0.04273903759028799]]}], "embedding": [[-0.09555099904537201, 0.16100333631038666, 0.114013671875, -0.10550063848495483, -0.17316247522830963, 0.0003031361848115921, -0.02101157419383526, -0.1523474156856537, 0.2055245339870453, -0.08199616521596909, 0.15374496579170227, -0.14285975694656372, -0.21737152338027954, -0.02694089710712433, -0.07539112865924835, 0.24140071868896484, -0.17529304325580597, -0.21227288246154785, -0.11455661058425903, -0.04663703963160515, -0.02666894719004631, 0.001536218449473381, 0.03450958803296089, 0.08960705995559692, -0.11777001619338989, -0.39649659395217896, 0.03918265178799629, 0.009057432413101196, -0.0031562689691781998, -0.11602485179901123, 0.018092213198542595, 0.24065245687961578, -0.18606367707252502, -0.005706915631890297, -0.012779219076037407, 0.16050094366073608, -0.06945296376943588, -0.1276630461215973, 0.22517135739326477, -0.003785761073231697, -0.2972310185432434, -0.020925864577293396, 0.024193856865167618, 0.3356132507324219, 0.25565844774246216, -0.07252389192581177, 0.0013285166351124644, -0.044685542583465576, 0.15590234100818634, -0.34999752044677734, 0.08624151349067688, 0.1861003190279007, 0.0319412499666214, 0.030668139457702637, 0.0346926748752594, -0.1464601308107376, -0.011154953390359879, 0.10815595090389252, -0.22219833731651306, -0.02331114374101162, 0.13032041490077972, -0.14427004754543304, -0.04789900407195091, -0.19844754040241241, 0.13685472309589386, 0.1699795126914978, -0.08447131514549255, -0.144407719373703, 0.17018888890743256, -0.103545181453228, -0.02784065529704094, 0.02097257226705551, -0.12993858754634857, -0.17165662348270416, -0.3161972463130951, -0.012428290210664272, 0.31125408411026, 0.1548791378736496, -0.16219519078731537, -0.014534791931509972, -0.028455864638090134, -0.008602878078818321, -0.02085123397409916, 0.11690464615821838, -0.012760691344738007, -0.02326570451259613, -0.0806707963347435, 0.07665363699197769, 0.15195253491401672, -0.0440463125705719, -0.06744293868541718, 0.28329700231552124, 0.022604838013648987, -0.09674552828073502, -0.053441137075424194, 0.058107901364564896, -0.10260812193155289, 0.10332262516021729, -0.20232537388801575, 0.014880817383527756, 0.032586369663476944, 0.0059830378741025925, 0.003903573378920555, 0.11562206596136093, -0.21585631370544434, 0.2508561313152313, 0.0027535390108823776, 0.06529760360717773, 0.018312672153115273, -0.09627360850572586, -0.07973918318748474, -0.025065289810299873, 0.19842973351478577, -0.20414122939109802, 0.12313675135374069, 0.1656058132648468, 0.09502585232257843, 0.1603691279888153, 0.07435094565153122, 0.03584934026002884, 0.08582143485546112, -0.05960646644234657, -0.17060241103172302, -0.03811211884021759, 0.0926462784409523, -0.026989353820681572, -0.021829772740602493, 0.15693193674087524], [-0.19912414252758026, 0.11310044676065445, 0.10596735775470734, -0.09305858612060547, -0.19174526631832123, -0.037992872297763824, -0.03418964520096779, -0.14689524471759796, 0.18345510959625244, -0.2107744961977005, 0.09103585034608841, -0.038803961127996445, -0.13419920206069946, 0.13754549622535706, -0.08009887486696243, 0.12083140015602112, -0.14264066517353058, -0.13691620528697968, -0.03379198908805847, -0.08073707669973373, -0.023350872099399567, -0.013377414084970951, 0.02212318778038025, 0.09961340576410294, -0.11194176971912384, -0.34542179107666016, -0.11990387737751007, -0.06612789630889893, -0.040249522775411606, -0.000568790826946497, 0.04518583416938782, 0.03417780250310898, -0.16206079721450806, -0.015255659818649292, -0.042158015072345734, 0.055601101368665695, -0.11929797381162643, -0.050411637872457504, 0.2021344006061554, -0.019239526242017746, -0.2718188762664795, 0.009329663589596748, 0.05227317288517952, 0.299659788608551, 0.2596239447593689, 0.022927507758140564, 0.025882553309202194, -0.08490794897079468, 0.20189611613750458, -0.27401506900787354, 0.061983928084373474, 0.1066640317440033, 0.016324196010828018, 0.005902301520109177, 0.10248390585184097, -0.08381611108779907, 0.04600672796368599, 0.13504137098789215, -0.166660875082016, 0.02652529813349247, 0.136223703622818, -0.08560866117477417, 0.025548160076141357, -0.05189378932118416, 0.2504345774650574, 0.1853356957435608, -0.058741457760334015, -0.14730456471443176, 0.2494833916425705, -0.20922186970710754, 0.0031270072795450687, 0.1085415631532669, -0.08667396754026413, -0.20909494161605835, -0.19186951220035553, 0.0469689704477787, 0.37100279331207275, 0.20633013546466827, -0.008660205639898777, 0.01866273209452629, -0.07590781152248383, 0.035775262862443924, 0.08886750787496567, 0.10508541762828827, -0.06600047647953033, -0.06192578375339508, -0.04652952775359154, 0.01140403002500534, 0.24022746086120605, 0.0030888470355421305, -0.06105293333530426, 0.23491966724395752, 0.043827518820762634, -0.09871334582567215, 0.04527592658996582, 0.05719098448753357, -0.19608630239963531, 0.02134275808930397, -0.20863457024097443, -0.009449198842048645, 0.007893296889960766, 0.0013002674095332623, 0.005520444363355637, 0.12713629007339478, -0.22509697079658508, 0.2092984914779663, -0.1340453028678894, -0.010865282267332077, -0.06895396113395691, -0.05850188434123993, -0.08393965661525726, 0.014516854658722878, 0.14761151373386383, -0.1992620974779129, 0.11173040419816971, 0.08736229687929153, -0.004731782246381044, 0.17608331143856049, 0.0701696053147316, -0.004268733784556389, 0.013340242207050323, -0.04153905063867569, -0.17485269904136658, -0.04100392758846283, 0.11401185393333435, -0.06532545387744904, 0.07744408398866653, 0.04035797715187073], [-0.11083175241947174, -0.008426103740930557, -0.03031899780035019, -0.06919342279434204, -0.10449941456317902, -0.10146000981330872, 0.004085135646164417, -0.06473754346370697, 0.1586197167634964, -0.10264547169208527, 0.15072154998779297, -0.017335155978798866, -0.23801189661026, -0.09513352811336517, -0.026668913662433624, 0.06953546404838562, -0.19157296419143677, -0.13276009261608124, -0.10630708187818527, -0.17597579956054688, 0.052454933524131775, 0.02077970840036869, -0.033954326063394547, -0.030674347653985023, -0.13216018676757812, -0.31584432721138, -0.07011326402425766, -0.14082202315330505, 0.1337193250656128, -0.09803490340709686, 0.09192274510860443, 0.1353990137577057, -0.11999844014644623, -0.10131365060806274, 0.002048984169960022, 0.049757957458496094, 0.03187915310263634, -0.020126823335886, 0.27284812927246094, 0.00872001051902771, -0.15878164768218994, -0.0029004625976085663, 0.07960819453001022, 0.3008769452571869, 0.20626477897167206, -0.020551851019263268, 0.057172589004039764, -0.023166941478848457, 0.2137724906206131, -0.2076154351234436, 0.08358553797006607, 0.14057864248752594, 0.2059171199798584, 0.03267420083284378, 0.14733639359474182, -0.1418784260749817, -0.00035900436341762543, 0.13213282823562622, -0.23983822762966156, 0.1000661849975586, 0.09251684695482254, -0.10560590028762817, -0.10406635701656342, -0.021798595786094666, 0.09445758163928986, 0.01273965835571289, -0.05924282595515251, -0.13301487267017365, 0.2785544991493225, -0.13701769709587097, -0.05158807337284088, 0.05363340303301811, -0.10270749777555466, -0.09226787090301514, -0.2483098804950714, 0.023037932813167572, 0.33675000071525574, 0.09501002728939056, -0.118843674659729, 0.09582271426916122, -0.07013839483261108, -0.0923575609922409, 0.03174939006567001, -0.001870499923825264, -0.06963229179382324, -0.06372886151075363, -0.08119206130504608, 0.047561343759298325, 0.1301455795764923, 0.01460215449333191, -0.025986695662140846, 0.11997301876544952, 0.03273420035839081, -0.045829884707927704, 0.05430135130882263, 0.0670628771185875, -0.18666532635688782, -0.021125217899680138, -0.10567526519298553, -0.05116601660847664, 0.14443713426589966, -0.16226083040237427, 0.015594061464071274, 0.06063693016767502, -0.17102964222431183, 0.21750245988368988, -0.02456943318247795, 0.005646850913763046, -0.04342526197433472, -0.0482649952173233, -0.028390277177095413, 0.07781729102134705, 0.17324042320251465, -0.1903623342514038, 0.198843315243721, 0.13710230588912964, -0.018996501341462135, 0.16643498837947845, 0.0357469841837883, 0.0021855831146240234, -0.0048753563314676285, -0.04370753839612007, -0.20061466097831726, -0.1680174469947815, -0.039891451597213745, 0.010210918262600899, 0.02920261025428772, 0.08030089735984802], [-0.10105118900537491, 0.0685158520936966, 0.12290483713150024, -0.08109816908836365, -0.13829240202903748, -0.030604951083660126, 0.031518179923295975, -0.08302783966064453, 0.2524496018886566, -0.12668538093566895, 0.13867506384849548, -0.055843643844127655, -0.28421467542648315, 0.060379885137081146, -0.02854311466217041, 0.16928496956825256, -0.21350954473018646, -0.20485936105251312, -0.022078394889831543, 0.005135660991072655, 0.09498246759176254, 0.004343104548752308, 0.05010414496064186, 0.05403031408786774, -0.1755346953868866, -0.3620776832103729, -0.1649441421031952, -0.03929172828793526, -0.048520125448703766, -0.021776355803012848, 0.04312663525342941, 0.06825757771730423, -0.15866711735725403, -0.038399145007133484, 0.09873704612255096, 0.04452918469905853, -0.0637952908873558, -0.263394832611084, 0.18404266238212585, 0.015429641120135784, -0.2529401481151581, -0.0930786281824112, 0.055771976709365845, 0.2665455639362335, 0.19254013895988464, -0.007163079455494881, -0.003668401390314102, -0.11008425056934357, 0.11281418055295944, -0.34257927536964417, 0.05003039911389351, 0.18990632891654968, 0.03471185639500618, 0.05767303332686424, 0.09107767045497894, -0.13738739490509033, 0.0819857120513916, 0.1584147959947586, -0.25993773341178894, 0.03294035419821739, 0.09060312807559967, -0.13158591091632843, 0.021561671048402786, -0.1215762123465538, 0.10352414846420288, 0.1535012423992157, -0.13737428188323975, -0.13130918145179749, 0.16814367473125458, -0.1477411687374115, 0.010630546137690544, 0.04906647652387619, -0.1745961755514145, -0.30140426754951477, -0.2024002969264984, -0.0386543832719326, 0.40463557839393616, 0.18347272276878357, -0.12593068182468414, -0.04380251467227936, -0.0581994466483593, 0.06023385375738144, 0.02524534985423088, 0.14269593358039856, -0.009530367329716682, -0.0844326913356781, -0.11579626053571701, 0.04288889095187187, 0.2257557362318039, -0.10368996858596802, -0.06346160918474197, 0.27130115032196045, -0.03402264416217804, -0.12788152694702148, 0.023566851392388344, 0.07976812869310379, -0.10896559804677963, 0.05298768728971481, -0.17038795351982117, 0.011268280446529388, 0.01504220999777317, -0.07066524773836136, -0.052752189338207245, 0.11404122412204742, -0.1920924335718155, 0.0643681064248085, -0.011935201473534107, -0.11256472766399384, -0.045976195484399796, -0.16036762297153473, -0.17205344140529633, -0.03194429725408554, 0.15238584578037262, -0.24374039471149445, 0.1519966423511505, 0.2072836458683014, -0.007266482338309288, 0.21633553504943848, -0.006069302558898926, 0.07916797697544098, 0.03207412362098694, -0.1211070716381073, -0.09015271067619324, -0.0819355845451355, 0.054380252957344055, 0.06905446201562881, 0.003413834609091282, -0.04826675355434418], [-0.1317601203918457, 0.08566931635141373, 0.03223549574613571, -0.0076329149305820465, -0.07194279879331589, -0.08208703249692917, -0.012437853962182999, -0.12107841670513153, 0.08703897148370743, -0.06259439140558243, 0.22010868787765503, -0.06373400241136551, -0.25012969970703125, -0.04278326407074928, -0.061506275087594986, 0.13810782134532928, -0.1460530310869217, -0.038189709186553955, -0.24118754267692566, -0.13167399168014526, 0.026474829763174057, 0.03513995558023453, 0.08379387855529785, -0.020026620477437973, -0.14405927062034607, -0.2491932213306427, -0.03180642053484917, -0.07230058312416077, 0.08246190845966339, -0.05906286463141441, 0.010455312207341194, 0.10049304366111755, -0.26480743288993835, -0.12121391296386719, -0.003548629581928253, -0.0064993673004209995, -0.06051916256546974, -0.025818366557359695, 0.2420918345451355, 0.042692024260759354, -0.17575518786907196, 0.026179317384958267, -0.020802631974220276, 0.2213136851787567, 0.24607034027576447, -0.030506888404488564, -0.027998482808470726, -0.062339186668395996, 0.12024790048599243, -0.3132965862751007, 0.015613519586622715, 0.1779041588306427, 0.07255423814058304, 0.10199952125549316, 0.018924513831734657, -0.12230619043111801, 0.05873775854706764, 0.12183993309736252, -0.19798621535301208, 0.0512763187289238, 0.11464959383010864, -0.19450688362121582, -0.034708403050899506, -0.04004047438502312, 0.04615582153201103, 0.09522724151611328, -0.0514916256070137, -0.09658438712358475, 0.15566754341125488, -0.09891489893198013, 0.0712931677699089, 0.07742604613304138, -0.08328402042388916, -0.19454732537269592, -0.3237733244895935, 0.03504788130521774, 0.3104519248008728, 0.18454128503799438, -0.13587234914302826, -0.031343840062618256, -0.11732566356658936, 0.023368900641798973, 0.06617419421672821, -0.06200949102640152, -0.09482520073652267, -0.06200771778821945, -0.06057383492588997, 0.073717400431633, 0.1419648975133896, -0.044904086738824844, -0.08640635013580322, 0.26504233479499817, -0.011502668261528015, -0.03649939224123955, 0.07301725447177887, 0.07583572715520859, -0.1336018592119217, -0.09187649190425873, -0.11173474788665771, 0.0496302992105484, 0.056338366121053696, -0.1821882575750351, 0.038979701697826385, 0.041744254529476166, -0.10069452226161957, 0.16352824866771698, -0.05109165236353874, 0.021570993587374687, -0.05722763016819954, -0.07622262090444565, -0.09383565187454224, 0.0440315380692482, 0.1574743539094925, -0.12336299568414688, 0.2978881597518921, 0.18156036734580994, -0.028640324249863625, 0.147153839468956, 0.1303107738494873, 0.03826127201318741, -0.0922948569059372, 0.011988095939159393, -0.06922439485788345, -0.15255823731422424, 0.06797333061695099, 0.03973044827580452, 0.09655510634183884, 0.026927094906568527], [-0.1953759491443634, 0.11616070568561554, 0.04952749237418175, -0.0625142753124237, -0.12232927978038788, -0.07125937193632126, -0.09838294982910156, -0.14440694451332092, 0.1507897675037384, -0.07727353274822235, 0.19383589923381805, -0.04409119486808777, -0.1804366260766983, -0.022723108530044556, -0.1360623985528946, 0.20516836643218994, -0.2316243052482605, -0.20586465299129486, -0.05514538288116455, -0.012581542134284973, 0.025786716490983963, -0.03176800534129143, 0.037194106727838516, 0.06949266791343689, -0.14290805160999298, -0.39243873953819275, -0.07709622383117676, -0.05923723429441452, 0.0018115940038114786, -0.012223459780216217, 0.0241513941437006, 0.07155432552099228, -0.2252202033996582, -0.04557530954480171, 0.040545571595430374, 0.08057137578725815, 0.0694110170006752, -0.13488827645778656, 0.1820911318063736, -0.06456223130226135, -0.2853987514972687, -0.06493481248617172, 0.1098601445555687, 0.26444289088249207, 0.17635099589824677, -0.06139986589550972, 0.06326072663068771, -0.12408971041440964, 0.15555179119110107, -0.18372872471809387, 0.052130624651908875, 0.13453523814678192, 0.02451041154563427, 0.017626237124204636, 0.03932303190231323, -0.141190305352211, 0.03293476998806, 0.12657292187213898, -0.14540521800518036, -0.04535806179046631, 0.07833290100097656, -0.005611127242445946, -0.02573331445455551, -0.13900743424892426, 0.1876329779624939, 0.17016184329986572, -0.09544135630130768, -0.23866397142410278, 0.1950165331363678, -0.12035998702049255, -0.002939896658062935, 0.03845291584730148, -0.14555370807647705, -0.1683969646692276, -0.3372572064399719, -0.03951326012611389, 0.34885478019714355, 0.09857738018035889, -0.15239453315734863, 0.07416006177663803, -0.0462246797978878, -0.005949161946773529, 0.03855734318494797, 0.1447109580039978, -0.04708985984325409, 0.1086229532957077, -0.11320115625858307, 0.03804444894194603, 0.2451222687959671, 0.009034529328346252, -0.0743163526058197, 0.16956205666065216, -0.022814467549324036, -0.07165074348449707, 0.08896931260824203, 0.13339684903621674, -0.16781997680664062, 0.023959200829267502, -0.2034907341003418, 0.008165013045072556, 0.05379018932580948, 0.04875408858060837, -0.02823106199502945, 0.13586261868476868, -0.0898415818810463, 0.08842305094003677, -0.03272230550646782, 0.037077344954013824, -0.055292367935180664, -0.03348226845264435, -0.06478527188301086, -0.08514159172773361, 0.11211563646793365, -0.12054508924484253, 0.17039181292057037, 0.0732864961028099, 0.0326225608587265, 0.15554893016815186, 0.11273061484098434, 0.057724714279174805, -0.020757699385285378, 0.0008560828864574432, -0.13159121572971344, -0.05334945023059845, 0.06255146116018295, -0.05255579948425293, 0.09134221076965332, 0.02642076462507248], [-0.032503001391887665, 0.02013520523905754, 0.04763973504304886, -0.06322728097438812, -0.017650991678237915, -0.05488434061408043, 0.0016862023621797562, -0.05150897055864334, 0.08872608095407486, 0.002252791542559862, 0.24601168930530548, -0.05109585076570511, -0.22707918286323547, -0.09594018757343292, -0.0467873178422451, 0.0967026948928833, -0.15864787995815277, -0.06826885044574738, -0.1388961523771286, -0.1583675891160965, 0.08352729678153992, 0.04565753787755966, 0.05242960527539253, 0.10219034552574158, -0.24864965677261353, -0.2054588347673416, -0.0847189873456955, -0.1685318648815155, 0.04462369531393051, -0.11370782554149628, 0.04437728226184845, 0.06409904360771179, -0.18228492140769958, -0.09471423923969269, 0.03192223608493805, 0.03588150069117546, -0.016538191586732864, -0.08955013751983643, 0.15442314743995667, 0.0360126867890358, -0.12391982227563858, 0.14790651202201843, 0.04856511577963829, 0.2782529890537262, 0.22512604296207428, 0.013139177113771439, 0.041232530027627945, -0.09898475557565689, 0.1366262137889862, -0.23987148702144623, 0.14252407848834991, 0.12032388150691986, 0.15276435017585754, 0.07245717942714691, 0.1353827714920044, -0.11572003364562988, -0.024237867444753647, 0.2301693707704544, -0.17063386738300323, 0.17080514132976532, 0.04369126260280609, 0.012267038226127625, 0.01332475058734417, -0.11451327800750732, -0.0034415237605571747, 0.033610112965106964, -0.12976208329200745, -0.10654206573963165, 0.1503874808549881, -0.1344010978937149, -0.058663297444581985, 0.15861806273460388, -0.11591240763664246, -0.21483877301216125, -0.27766504883766174, 0.13322597742080688, 0.3466844856739044, 0.19872823357582092, -0.1901906430721283, -0.016230175271630287, -0.05959086865186691, 0.03761933743953705, 0.04290449246764183, -0.0050288476049900055, -0.0485408790409565, -0.09060655534267426, -0.0524548701941967, 0.04901214316487312, 0.1467503011226654, -0.0026657916605472565, -0.053453028202056885, 0.2992626428604126, -0.013089245185256004, -0.040538642555475235, 0.018210802227258682, 0.05390964448451996, -0.1350427269935608, 0.0529986172914505, -0.10418957471847534, 0.02521906979382038, 0.04450581967830658, -0.10390078276395798, 0.013036264106631279, 0.031619079411029816, -0.13158413767814636, 0.10102246701717377, -0.019149772822856903, -0.0244196355342865, -0.013653401285409927, 0.05076272040605545, -0.16911707818508148, 0.012968271970748901, 0.188484787940979, -0.28907930850982666, 0.19613415002822876, 0.2133665233850479, 0.07349758595228195, 0.08077957481145859, 0.1158648133277893, 0.05145728215575218, 0.03461455553770065, -0.059410449117422104, -0.12422847002744675, -0.06694341450929642, 0.09565974771976471, -0.01687927544116974, 0.010533860884606838, 0.009955432265996933], [-0.05431688576936722, 0.020937873050570488, 0.0645132064819336, -0.13130271434783936, -0.12904559075832367, -0.0350111722946167, -0.020131180062890053, -0.05224763602018356, 0.2603417932987213, -0.14887435734272003, 0.017324047163128853, -0.05150360241532326, -0.19921600818634033, 0.12102243304252625, -0.07291790097951889, 0.15952539443969727, -0.20859619975090027, -0.2335115224123001, -0.08884205669164658, -0.07622936367988586, 0.03805357217788696, 0.07168565690517426, 0.0008366554975509644, 0.12817467749118805, -0.1650182604789734, -0.3655838668346405, -0.05594026297330856, -0.12413053214550018, -0.05779474601149559, -0.0335003025829792, 0.11775517463684082, 0.0726497545838356, -0.17575788497924805, 0.014440679922699928, 0.047864194959402084, 0.05293009430170059, -0.006775527261197567, -0.12122400104999542, 0.22987927496433258, 0.09697724878787994, -0.3049658536911011, -0.01878730207681656, 0.05519614741206169, 0.29048678278923035, 0.22376501560211182, -0.030088897794485092, -0.028523080050945282, -0.06777875125408173, 0.22052814066410065, -0.3743607997894287, 0.07851576805114746, 0.16058802604675293, 0.00830779504030943, 0.1363598108291626, 0.12656109035015106, -0.14452910423278809, 0.12296953052282333, 0.1490156501531601, -0.2103140503168106, 0.05239805951714516, 0.05781900882720947, -0.06621624529361725, 0.054526738822460175, -0.01397452037781477, 0.19892865419387817, 0.08005325496196747, -0.09550700336694717, -0.11777760833501816, 0.1501842588186264, -0.1705571562051773, -0.04473038762807846, 0.07376941293478012, -0.11198748648166656, -0.1894932985305786, -0.20819738507270813, 0.009680735878646374, 0.35790184140205383, 0.2264876365661621, -0.1669207364320755, 0.06395714730024338, -0.06829769909381866, 0.03353113308548927, 0.05175966024398804, 0.14601242542266846, -0.013269510120153427, 0.05090819299221039, -0.04620956629514694, 0.05283406376838684, 0.18472576141357422, 0.008136854507029057, -0.03229353949427605, 0.37278854846954346, 0.004187900573015213, -0.005341455340385437, 0.05071863532066345, 0.052726611495018005, -0.16534416377544403, 0.012244366109371185, -0.20720532536506653, -0.0687117651104927, 0.08978749811649323, 0.12249631434679031, 0.021418262273073196, 0.09783954918384552, -0.22633622586727142, 0.21717563271522522, -0.07682160288095474, -0.029324863106012344, -0.05823137238621712, -0.027134312316775322, -0.03737996146082878, 0.002033555880188942, 0.16810177266597748, -0.17732614278793335, 0.14412182569503784, 0.12707683444023132, 0.04237756133079529, 0.16564922034740448, 0.03165323659777641, -0.05999714136123657, 0.02131885662674904, -0.09920847415924072, -0.17547960579395294, 0.0011263471096754074, 0.09275525063276291, 0.0014747502282261848, -0.0002117697149515152, 0.03986369073390961]]}
]

var trainData = {}
var trainValues = {}

var faceMapping = null;

function preload () {
  extraFaceData = loadJSON('face_data.json');
  trainData = loadJSON('train_data.json');
  trainValues = loadJSON('train_values.json');
}

var allEmbeddingsTree;
var allEmbeddings = [];
var embeddingDimensions;
var curNeighbors = [];

function squaredDistance(a, b) {
  var sum = 0;
  var length = 128;
  for(var i=0; i<128; i++) {
    var diff = a[i] - b[i];
    sum += diff * diff;
  }
  // print(a.length,diff);
  // print(sum, a==b);
  return sum;
}

var haveStarted = false;
function setup () {
  var extraFaceDataArray = Object.values(extraFaceData);
  Array.prototype.unshift.apply(faceData, extraFaceDataArray);
  // create the drawing canvas, save the canvas element
  main_canvas = createCanvas(canvasWidth, canvasHeight);
  main_canvas.parent('canvasContainer');

  curRandomSeed = int(focusedRandom(0, 100));

  for(var i=0; i<NUMFACES; i++) {
    var face = new Face();
    facelist.push(face);
  }

  mainFace = new FaceMap();
  littleFace = new FaceMap();

  for(var i=0; i<faceData.length; i++) {
    var data = faceData[i];
    data.image = loadImage(data.url);
  }

  trainDataKeys = Object.keys(trainData);
  for(var i=0; i<trainDataKeys.length; i++) {
    var curKey = trainDataKeys[i];
    var data = trainData[curKey];
    var curEmbedding = data.embedding[0];
    if(curEmbedding.length == 128) {
      curEmbedding.push(curKey);
      allEmbeddings.push(curEmbedding);
    }
    else {
      print("rejected embedding ", curEmbedding);
    }
    data.image = loadImage(data.url);
  }
  // print("Length: ", allEmbeddings.length);
  // setup k-d tree
  var N = allEmbeddings[0].length - 1; 
  embeddingDimensions = Array.apply(null, {length: N}).map(Number.call, Number);  
  // print(embeddingDimensions)
  allEmbeddingsTree = new kdTree(allEmbeddings, squaredDistance, embeddingDimensions);
  // print(allEmbeddingsTree)

  faceSelector = createSelect();
  faceSelector.option('Face');
  faceSelector.option('FaceMap');
  faceSelector.option('Train');
  faceSelector.option('Neighbors');
  faceSelector.value('Neighbors');
  faceSelector.parent('selector1Container');

  /* create the sliders */
  for(i=1; i<=NUM_SLIDERS; i++) {
    var slider = createSlider(0, 100, 50);
    var parentStr = 'slider' + i + 'Container';
    slider.parent(parentStr);
    sliders.push(slider);
  }

  sliderTint = createSlider(0, 100, 10);
  sliderTint.parent("sliderTintContainer");

  /* and the buttons */
  var loadButton = createButton('load');
  loadButton.mousePressed(loadCurrentSettings);
  loadButton.parent('button1Container');

  var interpButton = createButton('interpolate');
  interpButton.mousePressed(interpolateCurrent);
  interpButton.parent('button1Container');

  var saveButton = createButton('save');
  saveButton.mousePressed(saveCurrentSettings);
  saveButton.parent('button2Container');

  var getValuesButton = createButton('get values');
  getValuesButton.mousePressed(getSingleJson);
  getValuesButton.parent('button3Container');

  var randButton = createButton('get all values');
  randButton.mousePressed(getAllJson);
  randButton.parent('button4Container');

  updateSlidersForTraining();

  // rotation in degrees
  angleMode(DEGREES);

  haveStarted = true;
}

function saveCurrentSettings() {
  var curKey = trainDataKeys[curTrainIndex];
  obj = mainFace.getProperties();
  trainValues[curKey] = obj;
  // for(var i=0; i<obj.length; i++) {
  //   trainData[curKey][i] = obj[i];
  // }
  var text = select('#output');
  text.html("Storing values for " + curKey);
  // getAllJson();
}

function getSingleJson() {
  obj = mainFace.getProperties();
  var text = select('#output');
  var json = JSON.stringify(obj, null, 2);
  text.html(json)
}

function getAllJson() {
  obj = trainValues;
  var text = select('#output');
  var json = JSON.stringify(obj, null, 2);
  // alert(json);
  text.html(json)
}

// global variables for colors
var bg_color1 = [50, 50, 50];

var lastSwapTime = 0;
var millisPerSwap = 5000;

function changeRandomSeed() {
  curRandomSeed = curRandomSeed + 1;
  lastSwapTime = millis();
}

function mouseClicked() {
  changeRandomSeed();
}

function draw () {
  var mode = faceSelector.value();

  if(millis() > lastSwapTime + millisPerSwap) {
    lastSwapTime = millis();
    // changeRandomSeed();
  }

  resetFocusedRandom(curRandomSeed);

  noStroke();
  background(bg_color1);
  var textDisplay = "unknown";

  var params = [];
  for(var i=0; i<NUM_SLIDERS; i++) {
    params.push(sliders[i].value());
  }

  if (mode == 'Face') {
    var w = canvasWidth / 10;
    var h = canvasHeight / 6;
    var max_shift = 0.2 * w;
    var cur_face = 0;
    for(var i=0; i<6; i++) {
      for(var j=0; j<9; j++) {
        var face = facelist[cur_face];
        cur_face = cur_face + 1;

        var y = h/2 + h*i;
        var x = w/2 + w*j;

        // shift even rows over by half a face
        if(i%2 == 0) {
          x = x + w/2;
        }

        // noFill();
        // stroke(255, 0, 0);
        // rect(x-w/2, y-w/2, w, h);
        face.randomize();
        face.draw1(x, y, w, h);
        // noStroke();
        // fill(255, 0, 0);
        // ellipse(x-2, y-2, 4, 4);
      }
    }
    textDisplay = "facegrid";
  }

  else if (mode == 'FaceMap' || mode == 'Train') {
    var do_train = true;
    if (mode == 'FaceMap') {
      do_train = false;
    }
    if(do_train) {
      // var keys = Object.keys(trainData);
      var curKey = trainDataKeys[curTrainIndex];
      var data = trainData[curKey];      
    }
    else {
      var data = faceData[curFaceIndex];
    }
    // Displays the image at its actual size at point (0,0)
    var img = data.image
    var x1 = (width/4-400/2);
    var x2 = (3*width/4-400/2);
    var y1 = (height/2-400/2);
    image(img, x1, y1, 400, 400);

    if(do_train) {
      if (curKey in trainValues) {
        fill(0, 200, 0);
      }
      else {
        fill(200, 0, 0);
      }
      ellipse(x1+400/2, y1+400+15, 10, 10);      
    }

    image(img, x2, y1, 400, 400);
    noStroke();
    var curSliderTintValue = sliderTint.value();
    var overlayAlpha = map(curSliderTintValue, 0, 100, 255, 0);
    fill(bg_color1[0], bg_color1[1], bg_color1[2], overlayAlpha);
    rect(x2, y1, 400, 400);
    stroke(0);
    fill(255);

    for(var i=0; i<data.landmarks.length; i++) {
      // get array of face marker positions [x, y] format
      var positions = data.landmarks[i];
      var shifted_positions = JSON.parse(JSON.stringify(positions))

      var data_mean = [0.0, 0.0];
      var data_scale = 1.0;
      var data_angle = 0.0;
      if ('transform' in positions) {
        data_mean = positions.transform.center;
        data_scale = positions.transform.scale;
        data_angle = positions.transform.angle;
        delete shifted_positions.transform
      }
      var scale_x = 400.0 / img.width;
      var scale_y = 400.0 / img.height;

      push();
      translate(x1, y1)
      translate(scale_x*data_mean[0], scale_y*data_mean[1]);
      scale(scale_x*data_scale, scale_y*data_scale);
      rotate(degrees(data_angle));

      stroke(0);
      fill(255);
      strokeWeight(1/data_scale);
      Object.keys(positions).forEach(function(key) {
        if (key=='transform') {
          return;
        }
        var curSection = positions[key];
        var shiftedSection = shifted_positions[key];
        for (var i=0; i<curSection.length; i++) {
          var cur_x = curSection[i][0];
          var cur_y = curSection[i][1];
          ellipse(cur_x, cur_y, 3/data_scale, 3/data_scale);
          // get ready for drawing the face
          shiftedSection[i][0] = cur_x;
          shiftedSection[i][1] = cur_y;
        }
      });

      noFill();
      stroke(0, 0, 255);
      ellipse(0, 0, 4, 4);
      line(0, -2, 0, 2);
      line(-2, 0, 2, 0);
      // ellipse(x1+data_mean[0], y1+data_mean[1], 4*data_scale, 4*data_scale);
      // line(x1+data_mean[0], y1+data_mean[1]-2*data_scale, x1+data_mean[0], y1+data_mean[1]+2*data_scale);
      pop();

      push();
      translate(x2, y1)
      translate(scale_x*data_mean[0], scale_y*data_mean[1]);
      scale(scale_x*data_scale, scale_y*data_scale);
      rotate(degrees(data_angle));
      strokeWeight(1/data_scale);
      mainFace.setProperties(params);
      mainFace.draw(shifted_positions);
      pop();
    }
    if(do_train) {
      textDisplay = "Train: " + curKey;
    }
    else {
      textDisplay = "FaceMap: " + curFaceIndex;
    }
  }

  else if (mode == 'Neighbors') {
    // var keys = Object.keys(trainData);
    var curKey = trainDataKeys[curTrainIndex];
    var data = trainData[curKey];

    // Displays the image at its actual size at point (0,0)
    var img = data.image
    var x1 = (width/4-250/2);
    var y1 = (height/3-250/2);
    image(img, x1, y1, 250, 250);
    if (curKey in trainValues) {
      fill(0, 200, 0);
    }
    else {
      fill(200, 0, 0);
    }
    ellipse(x1+250/2, y1+250+15, 10, 10);

    var y2 = (3*height/4-80/2);
    for(var i=0; i<4; i++) {
      // var keys = Object.keys(trainData);
      var curKey = curNeighbors[i];
      var nearData = trainData[curKey];      

      // Displays the image at its actual size at point (0,0)
      var img = nearData.image
      var x2 = (width/4 - 200 + i*100);
      image(img, x2, y2, 80, 80);
    }

    for(var i=0; i<1; i++) {
      // get array of face marker positions [x, y] format
      var positions = data.landmarks[i];
      var shifted_positions = JSON.parse(JSON.stringify(positions))

      var data_mean = [0.0, 0.0];
      var data_scale = 1.0;
      var data_angle = 0.0;
      if ('transform' in positions) {
        data_mean = positions.transform.center;
        data_scale = positions.transform.scale;
        data_angle = positions.transform.angle;
        delete shifted_positions.transform
      }
      var scale_x = 400.0 / img.width;
      var scale_y = 400.0 / img.height;

      Object.keys(positions).forEach(function(key) {
        if (key=='transform') {
          return;
        }
        var curSection = positions[key];
        var shiftedSection = shifted_positions[key];
        for (var i=0; i<curSection.length; i++) {
          var cur_x = curSection[i][0];
          var cur_y = curSection[i][1];
          // get ready for drawing the face
          shiftedSection[i][0] = cur_x;
          shiftedSection[i][1] = cur_y;
        }
      });


      var scale_x = 250.0 / img.width;
      var scale_y = 250.0 / img.height;
      var x2 = (3*width/4-250/2);
      push();
      translate(x2, y1);
      translate(scale_x*data_mean[0], scale_y*data_mean[1]);
      scale(scale_x*data_scale, scale_y*data_scale);
      rotate(degrees(data_angle));
      strokeWeight(1/data_scale);
      mainFace.setProperties(params);
      mainFace.draw(shifted_positions);
      pop();

      var scale_x = 80.0 / img.width;
      var scale_y = 80.0 / img.height;
      for(var j=0; j<4; j++) {
        // var keys = Object.keys(trainData);
        var curKey = curNeighbors[j];
        var x2 = (3*width/4 - 200 + j*100);

        push();
        translate(x2, y2);

        if (curKey in trainValues) {
          var settings = trainValues[curKey]
          translate(scale_x*data_mean[0], scale_y*data_mean[1]);
          scale(scale_x*data_scale, scale_y*data_scale);
          rotate(degrees(data_angle));
          strokeWeight(1/data_scale);
          littleFace.setProperties(settings);
          littleFace.draw(shifted_positions);
        }
        else {
          noFill();
          stroke(100);
          rect(10, 10, 70, 70);
        }
        pop();
      }
    }

    textDisplay = "Neighbors: " + trainDataKeys[curTrainIndex];
  }

  fill(255);
  textSize(32);
  textAlign(CENTER);
  text(textDisplay, width/2, height-12);
}

function keyTyped() {
  if(!haveStarted) {
    return;
  }
  var mode = faceSelector.value();
  if (key == '1' && mode != 'Face') {
    print("face")
    faceSelector.value('Face');
  }
  else if (key == '2' && mode != 'FaceMap') {
    print("facemap")
    faceSelector.value('FaceMap');
  }
  else if (key == '3' && mode != 'Train') {
    faceSelector.value('Train');
  }
  else if (key == '4' && mode != 'Neighbors') {
    faceSelector.value('Neighbors');
  }

  if (key == 's') {
    saveCurrentSettings();
  }
  else if (key == 'i') {
    interpolateCurrent();
  }
  else if (key == 'l') {
    loadCurrentSettings();
  }

  if (key == '!') {
    saveBlocksImages();
  }
  else if (key == '@') {
    saveBlocksImages(true);
  }
}

function interpolateCurrent() {
  var curNeighborSettings = [];

  for(var i=0; i<4; i++) {
    neighborKey = curNeighbors[i]
    if(neighborKey in trainValues) {
      curNeighborSettings.push(trainValues[neighborKey]);
    }
  }

  for(var i=0; i<NUM_SLIDERS; i++) {
    sliders[i].value(50);
  }

  if(curNeighborSettings.length > 0) {
    settings = curNeighborSettings[0];
    for(var i=0; i<settings.length; i++) {
      var sum = 0;
      for(j=0; j<curNeighborSettings.length; j++) {
        sum += curNeighborSettings[j][i];
      }
      var avg = int(sum / curNeighborSettings.length)
      sliders[i].value(avg);
    }
  }
}

function loadCurrentSettings() {
  var curKey = trainDataKeys[curTrainIndex];
  for(var i=0; i<NUM_SLIDERS; i++) {
    sliders[i].value(50);
  }    
  if (curKey in trainValues) {
    var settings = trainValues[curKey]
    for(var i=0; i<settings.length; i++) {
      sliders[i].value(settings[i]);
    }
  }
}

function updateSlidersForTraining() {
  var mode = faceSelector.value();
  var curKey = trainDataKeys[curTrainIndex];

  // first find the closest neighbors
  var nearest = allEmbeddingsTree.nearest(trainData[curKey].embedding[0], 5);
  curNeighbors = [];
  curNeighborSettings = [];
  for(var i=0; i<5; i++) {
    if(nearest[i][0][128] != curKey) {
      var neighborKey = nearest[i][0][128];
      curNeighbors.push(neighborKey);
      if(neighborKey in trainValues) {
        curNeighborSettings.push(trainValues[neighborKey]);
      }
    }
  }

  loadCurrentSettings();
  // if(mode == 'Neighbors') {
  //   interpolateCurrent();
  // }
  // else {
  //   loadCurrentSettings();
  // }
}

function keyPressed() {
  if(!haveStarted) {
    return;
  }
  var mode = faceSelector.value();
  if (mode == 'FaceMap') {
    if (keyCode == LEFT_ARROW || keyCode == UP_ARROW) {
      curFaceIndex = (curFaceIndex + faceData.length - 1) % faceData.length;
    } else if (keyCode === RIGHT_ARROW || keyCode == DOWN_ARROW) {
      curFaceIndex = (curFaceIndex + 1) % faceData.length;
    }
  }
  else if (mode == 'Train' || mode == 'Neighbors') {
    if (keyCode == LEFT_ARROW || keyCode == UP_ARROW) {
      curTrainIndex = (curTrainIndex + trainDataKeys.length - 1) % trainDataKeys.length;
      updateSlidersForTraining();
    } else if (keyCode == RIGHT_ARROW || keyCode == DOWN_ARROW) {
      curTrainIndex = (curTrainIndex + 1) % trainDataKeys.length;
      updateSlidersForTraining();
    }
  }
}
